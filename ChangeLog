2012-06-21  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-132

	* src/m_surface.cc (surface_scalar_reflectivityFromGriddedField4):
	Almost complet version (not tested practically).

	* src/m_atmosphere.cc (z_fieldFromHSE): Modified, adopted to
	pos2true_latlon.

	* src/rte.cc (pos2true_latlon): Created.

	* src/workspace.cc: Tried to improve description of refellipsoid,
	lat_true and lon_true.

	* src/check_input.cc (chk_latlon_true): Check for lon_true and 2D
	was incorrect. Now just perform checking (output arguments removed).

2012-06-18  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-131

	* src/methods.cc

	Add generic input 'dimension' to append functions. Passing in
	'leading' means to append to the leftmost dimension (e.g. rows for
	Matrix), 'trailing' to the rightmost (==cols).

	Add support to append single elements to arrays.

	Add support for Matrix.

	* src/groups.cc, src/wsv_aux.h (get_array_groups_as_string):

	Extend to return only Arrays whose basetype is a group and to return
	names of the basetypes of arrays only.

	* src/m_append.h:

	Implement append for Matrix.

2012-06-20  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-130

	* src/gridded_fields.h:

	Add checksize_strict member function that throws a runtime error with
	additional information on the grid and data sizes.

	Make checksize pure virtual in abstract base class.

	Remove redundant function documentation from subclasses. Doxygen
	automatically uses the docs from the base class.

	* src/gridded_fields.{cc,h}: Fix copyright header. Formatting.

	* src/xml_io_compound_types.cc (xml_read_from_stream):

	Use checksize_strict for GriddedFields.

2012-06-19  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-129

	* src/m_surface.cc (InterpSurfaceEmissivityFieldIncLatLon): Removed.

	(surface_scalar_reflectivityFromGriddedField4): Just a start ...

	* src/m_surface.cc: Removed .h-files and "extern const" not used.

2012-06-18  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-128

	* A first step in revising the surface RT properties part. Main
	change here is that methods taking emissivity as input are removed.

	* src/m_surface.cc (surfaceFlatReflectivity): Old method renamed,
	see below. This version ghanldes a general reflectivity matrix.
	Not yet tested practically.

	* controlfiles/artscomponents/doitbatch/TestDOITBatch.arts:
	* controlfiles/instruments/amsu/amsub.arts:
	* controlfiles/instruments/amsu/amsub_fast.arts:
	* controlfiles/instruments/mhs/mhs.arts:
	* controlfiles/instruments/mhs/mhs_fast.arts: Replaced
	surfaceFlatReflectivity with surfaceFlatScalarReflectivity.

	* src/m_surface.cc (surfaceFlatScalarReflectivity): Renamed
	surfaceFlatReflectivity. Now only stokes_dim = 1 accepted.

	(surfaceFlatSingleEmissivity):
	(surfaceFlatVaryingEmissivity): Both removed. Use instead
	surfaceFlatScalarReflectivity.

	* src/workspace.cc (define_wsv_data): Added surface_reflectivity.
	Changed text for complex_n, to always demand two columns. Some
	polishing of text for core surface RT variables.

2012-06-14  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-127

	* src/parameters.cc: Fix baseurl parameter.

2012-06-14  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-126

	* src/xml_io_compound_types.cc: Reading of GriddedField2 was broken.

2012-06-13  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-125

	* src/messages.h:

	Remove ; from the end of the CREATE_OUT* macros. This forces a ; to be
	added when the macro is used to make it look like a statement (which
	it is). Also fixes automatic indentation in some editors that get
	confused if a statement doesn't end with a semicolon.

	* src/*.{cc,h}: Add semicolons to CREATE_OUT* calls.

	* src/agenda_{class,record}.{cc,h}: Reindent.

	* src/arts.cc (arts_exit_with_error_message): Remove extra block.

2012-06-01  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-124

	* src/ppath.cc (rslope_crossing3d): The function now allows that
	both c1 and c2 to be zero.

2012-06-01  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-123

	* src/parameters.{cc,h}:

	Add outdir parameter and commandline option -o/--outdir.

	Change commandline argument -B to -U.

	* src/file.{cc,h}:

	Add add_basedir function.

	(open_output_file): Catch file exceptions and rethrow as runtime_error
	with additional info about the filename.

	* src/main.cc:

	No need to catch ios_base exception anymore. Handled in
	open_output_file now.

	* src/xml_io.cc, src/nc_io.cc:

	Use add_basedir in writing functions.

	* src/arts.cc (arts_exit): Use add_basedir for report file path.

2012-05-30  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-122

	* doc/uguide/ppath_theory.tex: Updated. Now treating the new 3D
	scheme (old scheme commented out).

2012-05-29  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-121

	* src/ppath.cc: New 3D code now made active. Now yet fully tested
	for non-spherical conditions (but no known loophole as for old
	scheme). Tell me if you run into some problems.

	* src/ppath.cc (ppath_step_refr_3d): Finally managed to track down
	another bug. Again a stupid typo. r16a and and r16b were written
	as r15a and r15b.

2012-05-29  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-120

	* src/ppath.cc (do_gridcell_3d): Fixed a typo. Had written lat in
	one function call where it should have been lon.

2012-05-28  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-119

	* doc/uguide/ppath_theory.tex: Fixed some typos, and updated to
	recent changes for refraction.

	* src/ppath.cc (plevel_crossing_2d): Zenith and nadir cases
	handled completly seperately (more effecient and more clear code).

	(plevel_crossing_3d): Changed to mimic 2D version as far as
	possible.

	* controlfiles/artscomponents/ppath/TestPpath3D.arts: Last part of
	test reactivated. Changes below fixed the bug.

	* src/ppath.cc (raytrace_3d_linear_basic): Handling of
	out-of-bounds za and aa angles was not correct. Now using
	adjust_los for this task.

	* src/rte.h: Added adjust_los.

	* src/rte.cc (adjust_los): Typo in header text.

2012-05-24  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-118

	* src/*, doc/uguide/arts*.tex: Update copyright year.

2012-05-24  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-117

	* src/docserver.* src/nc_io*, src/xml_io*:

	Reindent. Align & and * with type instead of variable.

2012-05-23  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-116

	* CMakeLists.txt:

	Handle compiler options more gracefully. Instead of hardcoding them
	for different compilers, check if the current compiler supports the
	flag. If not, just ignore it.

	Set and check flags separately for C and C++ compiler.

	For Xcode project, pass active configuration name to ctest so it can
	select the correct executable.

	* cmake/modules/ArtsAddCompilerFlag.cmake: Added.

	* src/libmicrohttpd/CMakeLists.txt, src/CMakeLists.txt:

	Little tweak for clang.

2012-05-18  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-115

	* src/gas_abs_lookup.h, src/nc_io_compound_types.cc, src/m_abs.cc,
	src/nc_io_types.h, src/nc_io.h, src/nc_io_basic_types.cc, src/m_nc.h,
	src/nc_io_instantiation.h, src/nc_io_array_types.cc, src/nc_io.cc:

	Change prefix of arts netcdf related functions from nc_ to nca_ to
	avoid confusion with functions from the netcdf library.

	* src/nc_io.{cc,h}: Add more helper functions. Add docs.

	* src/nc_io_compound_types.cc (nca_write_to_file):

	Clean up GasAbsLookup function.

	* doc/doxygen/Doxyfile.in: Add ENABLE_NETCDF to PREDEFINED macros.

2012-05-16  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-114

	* src/poly_roots.cc (gsl_poly_complex_solve): Removed screen
	message when bad convergence. This should be handled by calling
	function. Message left for the other (basic) errors.

	* src/ppath.cc (rslope_crossing2d): Increased standard n value to
	6. The function now adopts to poor poly_root-convergence. If this
	happens, n is decreased until convergence is achieved.

	* src/ppath.cc (do_gridcell_2d): Before did not check upper
	pressure level if a hit with the surface had been found, to save
	time. Found not OK with high surface radial slope. Fixed.

	(plevel_crossing_2d): Removed assert at end, that checked
	consistency with geompath. Why compare to a poorer calculation?

2012-05-16  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-113

	* src/nc_io.cc (nc_read_from_file, nc_write_to_file):

	Add a try-catch-block to the template functions around the actual
	type-specific read/write function call. Catch exceptions, add current
	filename and re-throw.

	* src/nc_io_compound_types.cc (nc_read_from_file):

	Throw runtime_error if no species are found in the GasAbsLookup input
	file.

	(nc_write_to_file): Throw runtime_error no species are in the current
	GasAbsLookup table.

	* src/gas_abs_lookup.h, src/nc_io_compound_types.cc,
	src/nc_io_types.h, src/nc_io_basic_types.cc, src/nc_io_array_types.cc,
	src/nc_io.cc:

	Add Verbosity argument to nc_read_from_file and nc_write_to_file.

2012-05-16  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-112

	* src/nc_io_compound_types.cc:

	Add NetCDF reading/writing for GasAbsLookup.

	* src/methods.cc: Add GasAbsLookup to Read/WriteNetCDF.

	* src/gas_abs_lookup.h: Some love for abs_lookup by adding friends.

	* src/nc_io.{cc,h}: Add helper functions.

2012-05-14  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-111

	* src/check_input.cc (chk_atm_surface): Checks for 3D cases
	covering North and South pole were missing. Added.

	* src/ppath.cc (plevel_crossing_2d): Output l was not calculated
	correctly if the level crossing is on other side of a tangent
	point. This seems not to happen inside the atmosphere, but can
	happen with a highly tilted surface. So this bug appeared only if
	the tangent point is just above a surface with high radial slope.
	Accordingly, showed up first after +300k of test cases!

2012-05-11  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-110

	* src/ppath.cc (rslope_crossing2d): Changed dza from 10 to 15 deg
	as limit for when going down from n=5 to n=4. Found one case of bad
	convergence for dza=10.7 (after running about 80000 cases).

2012-05-08  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-109

	* controlfiles/CMakeLists.txt:

	Install controlfiles/ into CMAKE_INSTALL_PREFIX/share/arts/

	* CMakeLists.txt: Remove tests/ from subdirectories.

2012-05-08  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-108

	* src/ppath.cc (do_gridcell_3d): Had commited with new test 3D
	code active.

2012-05-06  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-107

	* src/ppath.cc (rslope_crossing2d): Now n=5 default (with both
	terms included), and no special treatment of za=90 needed. Now
	going down to n=1 for za [89.9,90].

2012-05-01  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-106

	* src/ppath.cc (rslope_crossing2d): Setting of dmin adjusted.
	Added comments to document the selection of some settings.

	(plevel_crossing_2d): Changed back to set r as rpl+cpl*dlat.
	Bad decision to change. Further tests showed that the numerical
	problems were on the other side, in geompath.

2012-04-28  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-105

	* controlfiles/artscomponents/ppath/TestPpath3D.arts:
	* controlfiles/artscomponents/ppath/TestPpath2D.arts: Added several
	pos/los combinations, particularly for testing ray tracing along
	lat and lon grid positions. Also, now run with both spherical and
	non-spherical ellipsoid.

	3D non-spherical ellipsoid + refraction not active as it fails!

	* controlfiles/artscomponents/ppath/TestPpath1D.arts: Added a
	nadir from space case.

	* src/ppath.cc (ppath_init_structure): Start pos and los set to
	-999, to more clearly indicate non-valid data.
	
	(rslope_crossing2d): Now the polynomial degree is selected
	according to the zenith angle, to avoid (different) numerical
	problems around 0, 90 and 180. 

2012-04-27  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-104

	* doc/uguide/ppath_theory.tex: Updated with respect to change in
	rslope_crossing2d (now three terms in Taylor expansion of cos and
	sin).

2012-04-26  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-103

	* doc/uguide/atmosphere.tex: Some typos fixed.

	* doc/uguide/surface.tex: Part on geodetic latitude shortened.
	Spell-checking.

	* doc/uguide/ppath.tex (section{The propagation path data
	structure}): Updated with ngroup, start_lstep and end_lstep.

	* src/ppath.cc (rslope_crossing3d): Now using 2D version if c2=0.
	Required by poly_root_solve.

	* src/ppath.cc (rslope_crossing2d): Taylor expansion of cos and
	sin now includes also the third term. Was found to improve the
	accuracy significantly with non-spherical ellipsoid.

	(plevel_crossing_2d): New r now calculated by geompath function,
	instead as r+c*dlat. This looks the path to ppc, which improves
	the accuracy.

2012-04-24  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-102

	* src/ppath.cc (rslope_crossing3d): New function.

	(plevel_crossing_3d): Now using rslope_crossing3d.

	* src/rte.cc (get_iy_of_background): Adopted to changes below.

	* src/ppath.cc: Changes in several functions to adopt to the
	changes below.
	(plevel_slope_2d): Converted c1 from return to out
	parameter.
	(plevel_slope_3d): Now fitting local radius as a second order
	polynomial. Results now returned by reference.

2012-04-24  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-101

	* src/ppath.cc: Introduced the terms r0s etc. to avoid repeating
	calculations.

2012-04-23  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-100

	* src/ppath.cc: Restarted the postponed work to finish the new 3D
	code. The relevant parts copied back from ppath_NotUsed.arts.
	Added code to handle zanith&/nadir cases seperately. Some tests.
	Seems like that accuracy of plevel_crossing_3d must be improved.

	* src/geodetic.cc (latlon_at_aa): New function.

	* src/m_cloudbox.cc (cloudbox_checkedCalc): Added missing space in
	error message.

2012-04-20  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-99

	* controlfiles/general/general.src: refr_index_group initiated to 1.

	* arts/m_rte.cc (iyRadioLink): Extra path delay now calculated with
	ppath.ngroup (all below to fix this).

	* src/refraction.cc:
	* src/m_refraction.cc:
	* src/ppath.cc: Changes throughout the files to handle
	refr_index_group.

	* src/m_ppath.cc (ppathFromRtePos2):
	* src/m_ppath.cc (ppath_stepRefractionBasic)
	(VectorZtanToZaRefr1D): Changes associated with refr_index_group.

	* src/m_general.cc (Print):
	* src/xml_io_compound_types.cc: Adopted to new Ppath field (again!).

	* src/ppath.h (struct Ppath): Added ngroup.

	* src/agendas.cc: refr_index_agenda has now also refr_index_group
	as output.

	* src/workspace.cc: Added refr_index_group.

2012-04-18  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-98

	* src/m_refraction.cc (refr_indexFreeElectrons): Now including a
	test with respect to the plasma frequency. And now returning the
	"proper" refractive index (here a value below 1), corresponding to
	the phase speed which is required for the ray tracing. How to
	handle path delays is an open question?

2012-04-17  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-97

	* src/m_refraction.cc (refr_indexFreeElectrons): It was just
	sqrt(...). Corrected to 1/sqrt(...)

	* controlfiles/artscomponents/radiolink/TestRadioLink.arts: Now
	finer p_grid and cubic interpolation in AtmFieldsCalc.

	* src/m_ppath.cc:(ppathFromRtePos2): Azimuth angle now also stored
	in H. Fine-tuning of settings for surface intersections.

	* src/refraction.cc: Full WSV of t_field and vmr_field now used
	inside functions for refraction (for consistency + to handle empty
	vmr_field).

	* src/rte.cc (defocusing_sat2sat): Removed a cout.

	* src/check_input.cc (chk_atm_field): Now also handling the case
	when the Tensor4 is/shall be empty.

	* src/m_atmosphere.cc (basics_checkedCalc): Call chk_atm_field
	even if abs_species is empty.

2012-04-16  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-96

	* ChangeLog, ChangeLog-archived:

	Move all pre 2-0-0 entries to ChangeLog-archived.

	* ChangeLog-20071207: Renamed to ChangeLog-archived.

2012-04-16  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-95

	* controlfiles/instruments/smr: Moved from includes/smr/.

	* includes/: Removed.

2012-04-13  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-94

	* controlfiles/artscomponents/radiolink/TestRadioLink.arts: Now
	using iy_variable and iy_aux_variable.

	* src/m_ppath.cc (TangentPointExtract): New WSM.

	(TangentPointPrint): Renamed PrintTangentPoint.

	* src/m_rte.cc (iyRadioLink): Now using iy_variable and
	iy_aux_variable, instead of removed, corresponding, gin-variables.

	* src/workspace.cc: Introduced iy_variable and iy_aux_variable.

2012-04-13  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-93

	* This commit concludes the consolidation of controlfiles and
	includefiles into the controlfiles/ directory.

	Only open issue is the includes/smr directory. These files do not seem
	to be used anywhere. I left them in their original location for now.

	* src/file.{h,cc} (find_file):

	Don't go through search paths if filename already contains a full path.

	* src/xml_io.cc (xml_read_from_file,xml_read_arts_catalogue_from_file): 

	Throw runtime error immediately when we know the file doesn't exist
	instead of later when trying to actually open it.

	* src/parameters.cc (get_parameters): Add . to include and data paths.

	* src/parser.cc (ArtsParser::parse_agenda):

	When including a file with a path, we have to add the file's path
	temporarily at the beginning of the include path. This is necessary
	because the included file can include files from the same directory
	without specifying further path information. This mimics the behaviour
	how C/C++ compilers deal with include files. Problem is that we have to
	permanently add this path also to the data search path because include
	files can contain ReadXML etc. methods which are only executed later on.
	Not sure what a clean solution for that would be. #49

	* Missed to move two remaining controlfiles from tests/ in previous
	commit:

	* controlfiles/instruments/hirs: Moved from tests/HIRS.

	* controlfiles/instruments/avhrr: Moved from tests/AVHRR.

	* Moving include files into controlfiles/ sub-directories:

	* includes/amsu/*: Moved to controlfiles/instruments/amsu/.

	* controlfiles/instruments/amsu/*.arts:

	Remove amsu/ prefix for include and data files.

	* includes/mhs/*: Moved to controlfiles/instruments/mhs/.

	* controlfiles/instruments/mhs/*.arts:

	Remove mhs/ prefix for include and data files.

	* includes/odin/*: Moved to controlfiles/instruments/odinsmr/.

	* controlfiles/instruments/odinsmr/*.arts:

	Remove odin/ prefix for include and data files.

	* includes/hirs/*: Moved to controlfiles/instruments/hirs/.

	* controlfiles/instruments/hirs/*.arts:

	Remove hirs/ prefix for include and data files.

	* includes/avhrr/*: Moved to controlfiles/instruments/avhrr/.

	* controlfiles/instruments/avhrr/*.arts:

	Remove hirs/ prefix for include and data files. Change prefix to hirs
	includes to instruments/hirs/.

	* controlfiles/instruments/avhrr/TestAVHRR.ybatch.xml:

	Remove output file.

	* controlfiles/artscomponents/wfuns/TestWfuns.arts:

	Change prefix for odin include to instruments/odinsmr/.

	* include/CMakeLists.txt: Remove subdirs.

	* CMakeLists.txt:

	${CMAKE_SOURCE_DIR}/includes from ARTS_DEFAULT_INCLUDE_DIR.

	Remove subdirectory includes/.

2012-04-13  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-92

	* controlfiles/artscomponents/transmission/TestTransmission.arts:
	* controlfiles/artscomponents/radiolink/TestRadioLink.arts: Euler
	-> Basic.

	* controlfiles/artscomponents/ppath/TestPpath1D.arts:
	* controlfiles/artscomponents/ppath/TestPpath2D.arts:
	* controlfiles/artscomponents/ppath/TestPpath3D.arts: As above. 
	And now also making a set of calculations with refraction.

	* src/methods.cc: Improved text for ppath_stepRefractionBasic.

	* src/m_ppath.cc (ppath_stepRefractionBasic): Changed Euler to
	Basic in WSM name. This as "Euler" is not a totally correct
	description of the algorithm.

	* src/ppath.cc (ppath_start_stepping): For 3D, "ppath.end_lstep=lt;"
	was ppath.start_lstep = lt; Changed "euler" to "basic in some
	function names and variables.

2012-04-13  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-91

	* Completed moving of testcases from tests/ to controlfiles/.
	Next up is moving the include files into the appropriate directories
	in controlfiles/.

	* controlfiles/artscomponents/wfuns: Moved from tests/Wfuns.

	* controlfiles/artscomponents/radiolink: Moved from tests/RadioLink.

	* controlfiles/instruments/amsu: Moved from tests/AMSU.

	* controlfiles/instruments/mhs: Moved from tests/MHS.

	* controlfiles/instruments/odinsmr: Moved from tests/OdinSMR.

	* controlfiles/CMakeLists.txt: Add moved testcases.

	* tests/CMakeLists.txt: Remove moved testcases.

2012-04-12  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-90

	* Migrating controlfiles from tests to controlfiles/.
	Starting with controlfiles related to artscomponents.

	* CMakeLists.txt: Add subdirectory controlfiles.

	* tests/CMakeLists.txt: Remove testcases that are now in controlfiles/.

	* controlfiles/CMakeLists.txt: Added. Add testcase definitions.

	* controlfiles/artscomponents/absorption: Moved from tests/Abs.

	* controlfiles/artscomponents/doit: Moved from tests/DOIT.

	* controlfiles/artscomponents/montecarlo: Moved from tests/MonteCarlo.

	* controlfiles/artscomponents/ppath: Moved from tests/Ppath.

	* controlfiles/artscomponents/pencilbeam: Moved from tests/PencilBeam.

	* controlfiles/artscomponents/clearsky: Moved from tests/ClearSky.

	* controlfiles/artscomponents/groundbased: Moved from tests/GroundBased.

	* controlfiles/artscomponents/disort: Moved from tests/DISORT.

	* controlfiles/artscomponents/doitbatch: Moved from tests/DOITBatch.

	* controlfiles/artscomponents/transmission:

	Moved from tests/Transmission.

2012-04-12  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-89

	* controlfiles/atmosphere_data/:

	Moved here from tests. We might read those from arts-xml-data directly
	later.

	* tests/Transmission/TestTransmission.arts,
	tests/GroundBased/TestFgrid.arts,
	tests/GroundBased/TestWinds.arts,
	tests/GroundBased/TestGbased.arts,
	tests/PencilBeam/TestPencilBeam.arts,
	tests/DOIT/TestDOIT.arts,
	tests/Wfuns/TestWfuns.arts,
	tests/MonteCarlo/TestMonteCarloDataPrepare.arts,
	tests/Abs/TestAbsDoppler.arts,
	tests/Abs/TestAbs.arts,
	tests/OdinSMR/TestOdinSMR.arts,
	tests/OdinSMR/TestOdinSMR_119ghz.arts,
	tests/OdinSMR/TestOdinSMR_1D.arts,
	tests/Ppath/TestPpath1D.arts,
	tests/Ppath/TestPpath2D.arts,
	tests/Ppath/TestPpath3D.arts,
	tests/RadioLink/TestRadioLink.arts,
	tests/ClearSky/TestClearSky.arts:

	Remove ../ prefix from atmosphere_data path.


2012-04-12  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-88

	* Starting to move and rearrange controlfiles from tests/ to
	controlfiles. I'll do that in several steps to avoid mayhem.

	* CMakeLists.txt:

	Temporarily use includes/ and controlfiles/ as default include path.

	* controlfiles/general/general.arts,
	controlfiles/general/continua.arts,
	controlfiles/general/agendasDOIT.arts:

	Moved to here from includes/.

	* controlfiles, controlfiles/artscomponents, controlfiles/general,
	controlfiles/instruments: Added.

	* src/parameters.cc (get_parameters):

	Temporarily add support for having more than one path in
	ARTS_DEFAULT_INCLUDE_DIR.

	* tests/AVHRR/TestAVHRR.arts,
	tests/MHS/TestMHS.arts,
	tests/MHS/TestMHS_fast.arts,
	tests/Transmission/TestTransmission.arts,
	tests/GroundBased/TestFgrid.arts,
	tests/GroundBased/TestWinds.arts,
	tests/GroundBased/TestGbased.arts,
	tests/DOIT/TestDOIT.arts,
	tests/PencilBeam/TestPencilBeam.arts,
	tests/DOITBatch/TestDOITBatch.arts,
	tests/MonteCarlo/TestMonteCarloDataPrepare.arts,
	tests/MonteCarlo/TestMonteCarloGeneralGaussian.arts,
	tests/MonteCarlo/TestRteCalcMC.arts,
	tests/MonteCarlo/TestMonteCarloGeneral.arts,
	tests/DISORT/TestDISORT.arts,
	tests/HIRS/TestHIRS.arts,
	tests/Abs/TestAbsDoppler.arts,
	tests/Abs/TestAbs.arts,
	tests/AMSU/TestAMSUB.arts,
	tests/AMSU/TestAMSUB_fast.arts,
	tests/Ppath/TestPpath1D.arts,
	tests/Ppath/TestPpath2D.arts,
	tests/Ppath/TestPpath3D.arts,
	tests/RadioLink/TestRadioLink.arts,
	tests/ClearSky/TestClearSky.arts,
	includes/odin/odinsmr_544.arts,
	includes/odin/odinsmr_501_1D.arts,
	includes/odin/odinsmr_501.arts:

	Prepend general includes with general/.

2012-04-12  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-87

	* src/parser.cc (ArtsParser::parse_method_args):

	Bug fix. When the controlfile contained a call to a WSM that has
	generic output but all arguments were omitted, all hell broke lose.
	Try this controlfile with an older version ;-): Arts2 { ReadXML }

	Change exception type from UnexpectedChar to ParseError for
	missing generic inputs.

	(ArtsParser::parse_main):

	Instead of calling arts_exit directly in case of errors, rethrow the
	exception.

	* src/main.cc (main):

	Add a try catch block inside the main controlfile loop and add the
	current controlfile name to the error output.

2012-04-12  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-86

	* README: Updated. Add section headings. Add ctest documentation.

	* CMakeLists.txt:

	'make check' only runs quick controlfiles now. 'make check-all' runs
	all tests.

	Add cmake option TEST_JOBS to let user specify how many tests to be
	run in parallel. (cmake -DTEST_JOBS=4 ..)

	* cmake/modules/FindNetCDF.cmake:

	Netcdf library might also be called netcdf4/netcdf_c++4.

2012-04-12  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-1-85

	* src/cloudbox.cc:
	- use SI units with all pnd calculation functions.
	- remove (use of) scale_H11. let chk_pndsum do the work, which anyway
	  did the same plus some warnings.
	- corrected (?!) scaling in MP48 (we don't have a direct way to check
	  scaling based on precip rate. need to derive and use mass density
	  instead).
	- removed hard coded density of particles in cloud liquid PSD (H98).

	* src/cloudbox.h: adapted.

2012-04-11  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-84

	* tests/RadioLink/TestRadioLink.arts: Now checking atmospheric
	loss and extra path delay.

	* src/rte.cc (defocusing_general_sub): 1D calculations around
	zenith/nadir requires special treatment.
	
	* src/ppath.cc (raytrace_1d_linear_euler): The law of cosines was
	used to calculate new latitude, which wasfound to be numerically
	unstable around zenith and nadir. Now using combination of
	geompath functions, that seems to work much better.

	(raytrace_2d_linear_euler): As above.

	* src/rte.cc (iyb_calc): Code replaced by call of adjust_los.

2012-04-11  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-83

	* src/m_rte.cc (iyRadioLink): Prepared for using
	defocusing_general but so far inactive. 

	* src/ppath.h: Added declaration of cart2zaaa and cart2zaaa.

	* src/rte.cc: Replaced a number of "const Xxxxx&" with
	"ConstXxxxxView" where Xxxx is Vector etc.

	(adjust_los): New function.

	(defocusing_general):
	(defocusing_sat2sat): Complete. The two version give somewhat
	different results but a perfect agreement can not be expected. So
	OK right now. More detailed tests later on.

	Fails at least for 1D cases corresponding to za=0.

	* src/ppath.cc (raytrace_1d_linear_euler): Added an if-statement
	to handle poor accuracy for latitude when zenith angle = 0 or 180.

2012-04-09  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-82

	* src/m_rte.cc (iyRadioLink): Defocusing was not correctly iniated
	and applied.

	* src/rte.cc (defocusing3d, defocusing_limb1d): Started on two
	different aproaches to calculate defocusing. Not working and not
	active.

	* src/m_general.cc (Print): 
	* src/xml_io_compound_types.cc (xml_read_from_stream)
	(xml_write_to_stream): Adopted to end/start_lstep.

	* src/m_ppath.cc (PrintTangentPoint): Now using find_tanpoint.
	(ppathFromRtePos2): Adopted to end/start_lstep.

	* src/ppath.cc: Adopted to end/start_lstep.
	(find_tanpoint): New function.

	* src/ppath.h (struct Ppath): lspace removed. start_lstep and
	end_lstep introduced. (lspace was the sum of the two new fields,
	but this is not sufficient information for calculating
	defocusing).

2012-04-06  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-81

	* src/m_rte.cc (iyRadioLink): Now calculating the bending angle
	correctly (for 1D, approximative for 2D and 3D).
	Now the quantity for both iy and iy_aux can be selected.

	* src/workspace.cc: Description of refr_index polished. 

	* src/absorption.cc (refr_index_BoudourisDryAir)
	(refr_index_Boudouris): Removed. Old. Not used. Should not be in
	this file.

	* src/rte.cc (bending_angle1d): New function.

	* src/geodetic.cc: double was still hard-coded in this function! 
	(sphdist): New function.
	
2012-04-05  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-1-80

	* src/m_cloudbox.cc (pnd_fieldSetup):
	- moved all specific PSD calculation functionality into individual
	functions.
	- added Marshall&Palmer PSD for rain (also intended for use with snow,
	graupel/hail).
	- changed errors due to 'incorrect' profile or particle type
	into warnings, giving more freedom to the user how to name and combine
	things.

	* src/cloudbox.cc,cloudbox.h:
	added individual function for each implemented PSD type (currently:
	MH97, H11, H98_STCO, MP48).

2012-04-05  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-79

	* Switching to ctest!

	* CMakeLists.txt:

	Use ctest as the default for the check/check-fast targets.

	* tests/testall.py:

	Remove all tests that moved to the ctest interface. Only one left
	that was currently not used due to a dependency on PyARTS. I'll leave
	the code here for now.

	* cmake/modules/ArtsTestcases.cmake: Remove deprecated macros.

	* tests/CMakeLists.txt:

	Add last missing test Wfuns.

	Remove deprecated testing code.

2012-04-05  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-78

	* tests/testall.py,
	tests/MonteCarlo/TestMonteCarloGeneralGaussian.arts,
	tests/MonteCarlo/TestRteCalcMC.arts,
	tests/MonteCarlo/TestMonteCarloGeneral.arts:

	Move tests into the controlfiles.

	* tests/CMakeLists.txt: Add fast.odinsmr test.

	* cmake/modules/ArtsTestcases.cmake:

	Set arts screen output level for tests to 0 to only output the error
	in case of failure instead of the whole method log.

2012-04-04  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-77

	* src/m_rte.cc (iyRadioLink): Extended. Now handling dispersion
	and iy_aux set. Auxiliary variable to return can be selected (as a
	temporary solution?).

	* src/rte.cc (get_ppath_rtvars): Now using f_index.
	(get_iy_of_background): Adopted to agenda changes.

	* src/m_montecarlo.cc: Adopted call of iy_space_agenda. 

	* src/agendas.cc: f_grid new input for emission_agenda and
	iy_space_agenda. Needed to handle dispersion (and could be used to
	consider Doppler shift also for these terms).

	* src/workspace.cc: Introduced dispersion_do. 

2012-04-04  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-76

	* tests/Ppath/TestPpath3D.arts:
	* tests/Ppath/TestPpath2D.arts:
	* tests/Ppath/TestPpath1D.arts: Some changes. The files test
	different options for f_index = -1.

	* src/m_atmosphere.cc (basics_checkedCalc): Now also checking
	edensity_field.

	* includes/general.arts: edensity_field set to be empty. Adopted
	definition of ppath_step_agenda.

	* src/montecarlo.cc (iwp_cloud_opt_pathCalc):
	* src/m_rte.cc:
	* src/m_montecarlo.cc (MCIPA):
	* src/m_fos.cc:
	* src/m_doit.cc:
	* src/doit.cc:
	* src/ppath.cc:
	* src/m_ppath.cc: Numerous changes due to changes below (but all
	basically only to hand over variables to next function in the chain).

	* src/agendas.cc: Added edensity_field and f_index as input to
	ppath_agenda and ppath_step_agenda (edensity_field is presently
	not needed as agenda input, just in case if we want edensity
	jacobians in the future. To finish this, edensity_field must be
	added as input to iy_clearsky_agenda.).

	Reverted change for ppath_agenda. rte_los now only input. Not
	needed as output now with end_los added to Ppath structure.

	* src/refraction.cc: All functions consider now f_index and
	edensity_field.

2012-04-04  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-75

	* src/refraction.cc (get_refr_index_1/2/3d): Adopted call of
	refr_index_agenda, but so far just using local variables.

	* src/m_refraction.cc (refr_indexThayer): Now also doing the
	calculation (code moved from refr_index_thayer_1974). Works now in
	an additive way; refr_index is increased instead of set.
	(refr_indexIR): As above (but code from refr_index_ir).

	(refr_indexFreeElectrons): New WSM.

	(refr_indexUnit): Removed. Cfile even clearer if done as
	NumericSet( refr_index, 1.0 )

	* Src/refraction.cc (refr_index_thayer_1974,refr_index_ir): Removed.

	* tests/Ppath/TestPpath1D.arts:
	* tests/Ppath/TestPpath2D.arts:
	* tests/Ppath/TestPpath3D.arts: Removed definition of
	refr_index_agenda (was same as in general.arts).

	* includes/general.arts: Adopted definition of refr_index_agenda.

	* src/agendas.cc: Added f_index and rte_edensity to the input of
	refr_index_agenda.

	* src/workspace.cc: Introduced edensity_field and rte_edensity.

2012-04-03  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-1-74

	* src/methods.cc, workspace.cc:
	updating entries related to part_species redefinition.

2012-04-03  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-1-73

	* CAREFUL! THIS COMMIT BREAKS BACKWARD COMPATIBILITY!
	redefinition of part_species tag structure: third element now part_type
	(the material/phase of the individual particle as given in
	ScattMetaData, e.g., "Ice"), size selection shifted backwards. first
	element renamed part_type->prof_type (the type of particle bulk profile,
	e.g. "IWC").

	* src/m_cloudbox.cc, cloudbox.cc, src/cloudbox.h, m_atmosphere.cc:
	renamed (parse_)part_type -> (parse_)prof_type.

	* src/m_cloudbox.cc:
	(cloudboxSetAutomatically): removed hardwired prof_type-to-position-in-
	massdensity_field relation.
	(ScatteringParticlesSelect): removed hardwired prof_type-to-part_type
	relation.
	(pnd_fieldSetup): allow "H98_STCO" and "STCO" as more appropriate PSD
	selection tags for the current liquid cloud psd (which is continental
	stratus from Hess98). currently used "liquid" to be removed in future.

	* src/cloudbox.cc:
	(parse_prof_type): removed hard-wired restrictions on allowed prof_type
	names.
	(parse_part_type): added. function to parse part_species for part_type,
	the material/phase of the individual
	particle (e.g., "Ice").

	* src/cloudbox.h: adapted acc. to cloudbox.cc changes

	* src/methods.cc, workspace.cc:
	descriptions of several particle related methods updated.

	* tests/DOITBatch/TestDOITBatch.arts:
	adapted to new part_species structure.

2012-04-03  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-72

	* tests/RadioLink/TestRadioLink.arts: Updated. New target values
	include free space loss. Accuracy not effectively is fractional,
	as threshold set based on the reference value.

	* src/m_ppath.cc (ppathFromRtePos2): ppath.end_pos/los set
	to match the transmitter.

	* src/ppath.cc (ppath_calc): Changes in several functions to
	handle and set new Ppath fields.

	* src/m_general.cc (Print):
	* src/xml_io_compound_types.cc (xml_write_to_stream)
	(xml_read_from_stream): Added handling of new Ppath fields.

	* doc/uguide/ppath.tex: Described new fields of Ppath.

	* src/ppath.h: For Pppath struct, added fields start_pos,
	start_los, end_pos and end_los.

2012-04-03  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-71
	
	* src/mystring.h: Include algorithm for transform.

	* src/m_atmosphere.cc: Include algorithm no longer needed here.

2012-04-03  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-70
	
	* tests/CMakeLists.txt:

	Revert accidentally committed line that broke the clean target.

	Add TestMHS and TestMHS_fast to new tests.

	* tests/DOITBatch/TestDOITBatch.ybatch.xml:

	Renamed to TestDOITBatch.ybatch.ref.xml.

	* tests/DOITBatch/TestDOITBatch.arts,
	tests/MHS/TestAMSUB.arts, tests/MHS/TestAMSUB_fast.arts,
	tests/MHS/TestMHS.arts, tests/MHS/TestMHS_fast.arts:

	Compare results against reference.

	* tests/MHS/TestMHS.ybatch.ref.xml,
	tests/AMSU/TestAMSUB.ybatch.ref.xml:

	Add reference values.

	* tests/testall.py:

	Comment out test2 of DOITBatch. Now done inside the controlfile.
	Comment out test{2,3} of MHS. Now done inside the controlfiles.
	Comment out test{2,3} of AMSUB. Now done inside the controlfiles.

	* src/mystring.h: Implement toupper and tolower in my_basic_string.

	* src/m_atmosphere.cc (atm_fields_compactFromMatrix): Use toupper.

2012-04-03  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-69
	
	* src/m_rte.cc (iyRadioLink): Free space loss and path lengths
	now calculated (internally only).

2012-04-02  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-68

	* tests/RadioLink/TestRadioLink.arts: Somewhat more demanding for
	limb sounding. 

	* src/m_ppath.cc (ppathFromRtePos2): One of the tuning parameters
	had slipped back to an earlier, bad, value in the commit. 

2012-04-02  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-1-67

	* CAREFUL! THIS COMMIT BREAKS BACKWARD COMPATIBILITY!
	'ChevalAll' batch routines removed (functionality merged into basic
	batch routines). Also impacts:
	- setup of part_species (number, order, and naming needs to fit particle
	field names passed to batch_atm_fields_compactFromArrayOfMatrix - 
	equivalent to abs_species philosophy.)

	* src/m_atmosphere.cc
	(atm_fields_compactFromMatrix):
	- proper implementation of "ignore" (any columns, not only from the
	back, can be ignored now.)
	- now also to be used with batch atmospheres that include particle
	profiles. replaces atm_fields_compactFromMatrixChevalAll.

	(batch_atm_fields_compactFromArrayOfMatrix):
	- added catch when batch atmosphere arrayofmatrix is empty (e.g., cause
	reading-in accidentially removed from control file).
	- now also to be used with batch atmospheres that include particle
	profiles. replaces batch_atm_fields_compactFromArrayOfMatrixChevalAll.

	(AtmFieldsFromCompact):
	- adapted such that now also to be used with batch atmospheres that
	include particle profiles. replaces AtmFieldsFromCompactChevalAll.
	- added massdensity_field and part_species as input parameters.
	- non-hardwired handling of particle profiles (number, order, naming
	have to correspond to part_species definition. like vmr profiles to
	abs_species).

	(atm_fields_compactFromMatrixChevalAll,
	 batch_atm_fields_compactFromArrayOfMatrixChevalAll,
	 AtmFieldsFromCompactChevalAll): removed.

	* src/methods.cc
	(atm_fields_compactFromMatrixChevalAll,
	 batch_atm_fields_compactFromArrayOfMatrixChevalAll,
	 AtmFieldsFromCompactChevalAll): removed.
	(atm_fields_compactFromMatrix,
	 batch_atm_fields_compactFromArrayOfMatrix,
	 AtmFieldsFromCompact): adapted.

	* src/m_cloudbox.cc
	(ScatteringParticlesSelect):
	- throw error, when particle profile given, but no corresponding
	ScattData in selection.
	- replace error when no ScattData selected by a warning (should only
	occur when part_species empty, which occurs when using batch
	atmospheres, but having/wanting no particle profiles).
	- commented out check, whether all ScattData got selected (meaning
	of check unclear as well as whether it at all works as intended).

	(pnd_fieldSetup):
	- remove hardwiring of position of certain hydrometeor in
	massdensity_field and fixed link between particle profile type (IWC,
	LWC, etc.) and PSD. it's responsibility of the user to ensure profile
	type and PSD fit together (i.e., user here can now apply MH97 on LWC -
	not tested throughout, though. there might be further places hardwiring
	profile type and PSD relations.)!
	- catch case with no actual particles/ScattData linked to the particular
	part_species (though should never occur anymore, since already catched
	in ScatteringParticlesSelect
	- throw error, when given PSD is unknown

	* src/cloudbox.cc
	(chk_pndsum): added particle type (first part of part_species string) as
	input parameter, write clearer error message when pnd==0, but xwc!=0.

	(parse_psd_param): proper handling of incomplete part_species strings.
	remove check PSD validity here (now done in pnd_fieldSetup).

	* src/cloudbox.h (chk_pndsum): added part_type as passed parameter.

	* includes/general.arts: added part_species default setting (empty).
	required for AtmFieldsFromCompact for no-particle (i.e., clear-sky)
	batch cases.

	* tests/DOITBatch/TestDOITBatch.arts:
	adapted to new requirements (removed *ChevalAll calls, resorted
	part_species acc. to new requirements, ignore snow and rain).

2012-04-02  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-66

	* tests/CMakeLists.txt: Added RadioLink case. Placed transmission
	type cases (Transmission+RadioLink) between basic emission cases
	and the scattering cases.

	* tests/RadioLink/TestRadioLink.arts: Complete. (But calculations
	seems unstable, something is wrong. So far limb sounding case set
	to be simple.)

	* tests/Transmission/TestTransmission.arts:
	* tests/PencilBeam/TestPencilBeam.arts:
	* tests/Ppath/TestPpath3D.arts:
	* tests/Ppath/TestPpath2D.arts:
	* tests/Ppath/TestPpath1D.arts: Header text extended.

2012-04-02  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-65

	* tests/CMakeLists.txt: Added Transmission test (as fast).

	* tests/Transmission/TestTransmission.arts: New test.

	* tests/PencilBeam/TestPencilBeam.arts: Updated.

2012-04-02  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-64

	* cmake/modules/ArtsTestcases.cmake:

	Add convenience macros to create controlfile based tests.

	* tests/CMakeLists.txt:

	Add more new tests and use new macro to create them. MC test cases
	still need the check against reference values implemented.

	* src/xml_io.cc
	(xml_read_from_file,xml_read_arts_catalogue_from_file):

	Make sure we read the .bin file from the same path as the .xml file.

	* CMakeLists.txt: Tweak newcheck-fast.

2012-04-01  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-63

	* src/m_rte.cc (iyRadioLink): New WSM. So far just calculating the
	transmission (jacobians and iy_aux not yet handled). But first
	complete radio link calculations!

	* src/m_ppath.cc (ppathFromRtePos2): A complete version.

	* src/ppath.cc: Several functions adopted to change of ppath_copy.

	(ppath_copy): Handles now also partial copying of
	ppath2.

	(ppath_calc): Now completely silent. The output just makes it hard
	to get good reports from the WSM using this function. So moving
	the reporting to the WSMs.
	
2012-04-01  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-1-62

	* src/cloudbox.cc: some formatting for better readability.

	(IWCtopnd_MH97): MH97 PSD with noisy distribution parameters (gaussian
	noise according to error statistics given in MH97 paper). untested for
	stability, correct output etc. (but not breaking existing setups), so
	use with care.

	(scale_pnd): bugfix. for monodisperse case (no	integration) set pnd=dN.

	* src/cloudbox.h (IWCtopnd_MH97): adapted for noisy MH97 (see above).

	* src/m_cloudbox.cc: some formatting for better readability.

	(pnd_fieldSetup): adapted for noisy MH97 (see above).

	* src/mc_antenna.cc (ran_gaussian): fixed typo.

2012-03-31  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-61

	* src/ppath.cc (ppath_calc): Combined check of cloudbox_on and
	ppath_inside_cloudbox_do lacked a !. Added some assert for extra
	safety when running with ppath_inside_cloudbox_do set to true.

	(ppath_start_stepping): Also points on the cloudbox boundary are
	now flagged as inside cloudbox. That is, no start poinst can end
	up as "cloudbox boundary". This made the code shorter and avoids
	unsafe calculations of pressure levels tilts (the code was not
	complete on this point). Thos closed one point in TODO.

2012-03-30  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-60

	* tests/PencilBeam/TestPencilBeam.arts: mblock_index now needed to
	run iyCalc. Fixed.

2012-03-30  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-59

	* CMakeLists.txt, src/CMakeLists.txt, tests/CMakeLists.txt:

	Started utilizing the ctest facility of cmake. Should make it much
	easier to integrate tests in the future. Also, the output looks very
	clean compared to now.

	If you want to give it a try, run 'make newcheck' in the toplevel of
	the build directory. Note that only one controlfile is run at the
	moment. More to come.

2012-03-30  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-58

	* src/m_ppath.cc (ppathFromRtePos2): Still not complete, but a
	core algorith now established (after several tries).

	* src/geodetic.cc (line_circle_intersect,line_sphere_intersect):
	New functions.

	* src/check_input.cc (chk_rte_pos): What now is rte_pos[2] was
	rte_pos[1].

2012-03-30  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-57

	* tests/DOIT/TestDOIT.arts, tests/ClearSky/TestClearSky.arts,
	tests/testall.py:

	Started to move tests for verifying calculation results against
	reference values directly into the controlfiles. Removed corresponding
	tests from testall.py.

	* src/m_basic_types.cc, src/methods.cc: Add WSM NumericCompare.

	* src/parameters.cc (get_parameters):

	Fix crash for arts calls with no controlfile.

2012-03-29  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-56

	* src/file.{cc,h}: Add function get_dirname.

	* src/parameters.cc (get_parameters): Use get_dirname.

2012-03-29  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-55

	* src/parameters.cc (get_parameters):

	Fix indexing bug introduced accidentally right before committing.

2012-03-29  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-54
	
	* src/parameters.cc (get_parameters):

	If the controlfile is not in the current directory, add its location
	to the includepath.

2012-03-29  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-53
	
	* src/main.cc (main):

	Bugfix: If arts was called with a relative or full path to a
	controlfile, report files and output data with default filenames were
	written into the directory of the controlfile instead of the current
	directory.

2012-03-29  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-52

	* src/m_atmosphere.cc (AtmFieldsCalc):

	Add 1D support for VMR input profiles that do not cover the whole
	range of the target grid. Boundary values in the partial input profile
	must be 0.

	* src/check_input.{cc,h} (chk_interpolation_grids_loose):

	Add new check used by AtmFieldsCalc to determine the range of the
	new grid that is covered by the old grid. Also checks that boundary
	values are 0 in the input data.

	* src/m_basic_types.cc, src/methods.cc (VectorCompare, MatrixCompare):

	Make implementation and error output of both methods consistent. Add
	an optional String argument for passing a custom error message.

2012-03-28  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-51

	* src/m_ppath.cc (ppathFromRtePos2): Complete, but not always
	converging :-(  Will be fixed ...

	(rte_losGeometricFromRtePosToRtePos2): Now using pos2refell_r
	(making the function much shorter).

	(PrintTangentPoint): New WSM.

	* src/geodetic.cc (pos2refell_r): Was not OK for 3D. Had to add
	check with respect to lon_grid.

	* src/montecarlo.cc (mcPathTraceIPA):
	* src/rte.cc (get_iy_of_background):
	* src/refraction.cc (get_refr_index_3d, get_refr_index_2d):
	Replaced call of refell2r with refell2d (to be fully conistent
	with model definitions).

	* src/m_atmosphere.cc (z_fieldFromHSE):
	* src/doit.cc (cloud_ppath_update3D): Added comments that using
	refell2r is OK.

2012-03-28  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-50

	* tests/RadioLink/TestRadioLink.arts: Start on a new test cfile.

	* src/m_ppath.cc (ppathFromRtePos2): Further work ...

	* src/geodetic.cc (pos2refell_r): New function.

	* src/geodetic.h: Declaration of distance2D was incorrect.

2012-03-27  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-49

	* Same changes as for arts-2-0-40:

	* tests/Wfuns/TestWfuns.arts:
	* tests/GroundBased/TestGbased.arts:
	* tests/ClearSky/TestClearSky.arts: Adopted call of
	jacobianAddFreqShiftAndStretch.

	* src/m_jacobian.cc (jacobianAddFreqShiftAndStretch): df now
	carefully checked, to not give rise to an assert in interpolation
	applied in function below. f_grid had to be added is input.

	(jacobianCalcFreqShiftAndStretchInterp): The extrapolation factor
	for gridpos_poly now set to 1 (default of 0.5 was used before).

	(jacobianAddPointingZa): Added check that dza is inside [0,0.1],
	to avoid that unnecessary large values are used.

2012-03-27  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-48

	* src/ppath.cc (raytrace_2d_linear_euler): Expression for dlat can
	return NaN. If isnan, then set 0.
	Added also an if-statement to brake what can be become an infinite
	loop at tangent points.
	(This fixes so that test cfiles TestPpath1/2/3D.arts also run OK)
	(with refraction.)

2012-03-27  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-47

	* tests/Ppath/TestPpath1/2/3D.arts: Updated. Now using ppathCalc.

	* src/m_ppath.cc (ppath_stepGeometric,ppath_stepRefractionEuler):
	The case when called just to get nreal catched and handled seperately.

	* src/ppath.cc (ppath_start_stepping, ppath_calc): nreal was not
	always set for ppath having a single point.
	(do_gridcell_2d): Reintroduced some code to set exact value for
	zenith angle and latitude (when known). A case where numerical
	problems moved the latitude 1e-13 deg (!) outside the grid box was
	found.

	* src/m_ppath.cc (ppathCalc): Reintroduced this WSM, but now
	calling ppath_agenda (instead of ppath_calc).

2012-03-26  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-46

	* src/check_input.cc (chk_atm_field): Added check that 3D fields are
	constant with longitude for latitudes of +-90 deg (N- and S-pole).

	* src/m_ppath.cc (rte_losGeometricFromRtePosToRtePos2): New WSM
	(not yet heaviliy tested).
	(ppathFromRtePos2): Started on this WSM.

	* src/ppath.cc (ppath_calc): Now using the two new functions below.

	* src/check_input.cc (chk_rte_pos,chk_rte_los): New functions.

2012-03-26  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-45

	* src/m_ppath.cc (ppathToTransmitter): Just moved the (unused)
	code from ppath.cc to this file.

	* src/geodetic.cc (los2xyz): New function.

	* tests/MonteCarlo/TestRteCalcMC.arts: Added Ignore(mblock_index) to
	definition of iy_clearsky_agenda.

	* includes/general.arts: Added Ignore(mblock_index) and
	Touch(rteLlos) to definition of ppath_agenda.

	* src/rte.cc:
	* src/m_fos.cc:
	* src/m_rte.cc: Adopted to new agenda input described below.
	mblock_index is applied only for first part of rt calculation.
	That is, not inside cloudbox or after surface reflection
	(iy_clearsky_agenda or ppath_agenda is here given -1).

	* src/agendas.cc: Added mblock_index as input to
	iy_clearsky_agenda and ppath_agenda. rte_los added as output for
	ppath_agenda (needed to obtain bending angles for radio links).

	* src/workspace.cc: Added transmitter_pos and rte_pos2.

	* src/m_rte.cc:
	* src/m_sensor.cc:
	* src/rte.cc:
	* src/methods.cc:
	* src/m_jacobian.cc:
	* src/agendas.cc: imblock -> mblock_index.

	* src/workspace.cc: Renamed imblock to mblock_index (to fit naming
	pattern of f_index ybach_index ...).

	* src/m_doit.cc (CloudboxGetIncoming): Re-reverted (not just a
	workaround, in fact also a bit safer with respect to ending up
	with asserts).

2012-03-23  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-44

	* src/make_auto_md_cc.cc:

        Bugfix in auto-generated agendaExecute code. Even if a variable is only
	used as WSM output inside the current agenda, it is possible that it is
	used first as input further down by another nested agenda, which we
	can't see here. Therefore initialized variables have to be duplicated.
	Also, non-initialized WSM output-only variables were falsely flagged as
	initialized. Fixes bug reported by patrick.

	* src/methods.cc, src/m_doit.cc:

	Reverted patrick's workaround for the above bug from arts-2-1-42.

	* src/docserver.cc (Docserver::new_page):

	Fixed crash with new libc++. tokens.erase(tokens.end()) never did what
	it was meant to do (because end() is not a pointer to the last element,
	but behind it). Statement has no effect with the old libstdc++.
	Now replaced with the correct call tokens.pop_back();

2012-03-23  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-43

	* src/m_jacobian.cc (jacobianCalcTemperaturePerturbations): 
	molarmass_dry_air required for HSE calculations.

	* src/m_atmosphere.cc (z_fieldFromHSE): Now using
	molarmass_dry_air, and could potentially be used for planets
	beside Earth. The description (in methods.cc) updated.

	* includes/general.arts: molarmass_dry_air set to 28.966.

	* src/workspace.cc: Added molarmass_dry_air.

	* tests/PencilBeam: New folder with a simple test of monochromatic
	pencil beam calculations.

	* tests/Ppath/TestPpath1/2/3D.arts: Changed paths to files to work
	as (future) test cases.

2012-03-23  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-42

	* tests/DOITBatch/TestDOITBatch.arts: Moved up call of
	basics_checkedCalc and cloudbox_checkedCalc, to be placed before
	CloudboxGetIncoming. (This was already the case in TestDOIT.arts)

	* src/m_doit.cc (CloudboxGetIncoming): Now checking if
	basics_checked and cloudbox_checked are set to true.

2012-03-23  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-41

	* ppath_agenda introduced. With the exceptions: Not relevant for
	DOIT (inside cloudbox). Nothing changed for MC (as other
	ppath_step part is anyhow hard-coded inside MC).

	* Clean-up/bugfix regarding input to ppath_step_agenda and
	iy_clearsky_agenda. Caused changes in several files (list below
	probably not complete). If general.arts used, no changes should be
	needed.

	* src/m_ppath.cc (ppath_stepGeometricUpDown): Removed. More
	complete tests showed that for complete simulations the time gain
	is very small and then better to remove a method of such low
	generality.

	* src/ppath_NotUsed.cc (ppath_geom_updown_1d): Now placed here.

	* includes/general.arts: Now also defining ppath_agenda and
	ppath_inside_cloudbox_do.

	* src/workspace.cc: ppath_cloudbox_do was incorrectly declared as
	Numeric. Also renamed to ppath_inside_cloudbox_do, for better
	clarity. N.B., this is a variable that standard usage not need to
	consider. Just use value set in general.arts!

	* src/ppath.cc: Replaced outside_cloudbox with ppath_inside_cloudbox_do.

	* src/montecarlo.cc:
	* src/m_montecarlo.cc:
	* src/m_rte.cc:
	* src/m_jacobian.cc:
	* src/m_fos.cc: Adopted to agenda changes below.

	* src/agendas.cc (ppath_step_agenda): A bug found! Added t_field,
	z_field and vmr_field as agenda input. This is required for
	jacobian perturbation calculations, to allow that e.g.
	t-disturbances can affect the refractive index.

	(iy_clearsky_agenda): Removed p/lat/lon_grid as input. These
	variables were added to handle FOS-2D, but realises that these
	variables must be pushed own to ppath_step_agenda level to work.
	And also other variables must be passed on from agenda to agenda
	for totally correct results. How to handle this is a later issue!

	* src/m_atmosphere.cc (z2g): Removed another pow.

2012-03-23  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-40

	* src/file.cc (find_file):

	~ was not expanded properly for include paths passed by the -I
	commandline option.

2012-03-22  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-39

	* src/workspace.cc: Defined ppath_cloudbox_do. This WSV correponds
	to the ppath_calc input argument outside_cloudbox (but equals
	!outside_cloudbox).

	* src/agendas.cc: Defined ppath_agenda.

	* src/refraction.cc (refr_index_ir): As below + declared constants
	as static.

	* src/geodetic.cc (distance3D,distance3D): As below.

	* src/physics_funcs.cc: Replaced usage of pow with
	multiplications, eg. pow(f,3.0) -> f*f*f. To hopefully gain some
	calculation time.

2012-03-21  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-38

	* src/ppath.cc (ppath_to_transmitter): New function. Just started.

2012-03-21  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-37

	* src/physics_funcs.cc: Removed all hard-coding of double.

2012-03-21  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-36

	* src/geodetic.cc (cart2pol, ..., distance2D,distance3D): 2D
	version of existing 3D ones completed. And added functions for
	calculating the distance between two points.

2012-03-20  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-35

	* src/geodetic.cc: Started to make 2D versions of the functions,
	ie. pol2cart etc.

	* src/m_rte.cc (yCompareToReference): Renamed. See below. This as
	this version was unneceesarily tied to y, and to complement the
	existing matrixCompare WSM.

	* src/m_basic_types.cc (VectorCompare): The method above renamed
	and made more general (all input generic).

	* tests/Ppath/TestPpath1/2/3D.arts: ppathCalc replaced by
	ppathStepByStep.

	* src/m_ppath.cc (ppathCalc): Renamed (to make a better
	distinction to other ppath methods (to be created), calculating
	complete ppaths).
	(ppathStepByStep): New name of ppathCalc.

2012-03-19  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-34

	* src/workspace.cc: Stated dimension of diy_dx was wrong.

	* src/m_rte.cc (iyCalc, yFromIy,yCompareToReference): New WSMs.

	* src/rte.cc (iyb_calc,get_iy_of_background): Now placed in this file.
	(iyb_calc): Now using iyCalc.

	* src/m_atmosphere.cc (z_fieldFromHSE): Now using versions of the
	equations, and some changes to for efficiency. Chwecked to give
	same results as pt2z in atmlab.
	The only Earth specific setting now is average molecular weight of
	dry air. Shall this be a WSV or calculated from vmr_field (if
	constrain that sum up to 1 is introduced)?

	* src/m_ppath.cc: Removed EARTH_GRAV_CONST (not used).

	* src/constants.cc: Removed not used constants EARTH_GRAV_CONST,
	LOSCHMIDT_CONST, ATOMIC_MASS_UNIT, SUN_TEMP and PRES_STAND.
	Added GAS_CONST.
	Sorted alphabetically (beside when dependency demand other order).
	Set PI, DEG2RAD and RAD2DEG to value reported by matlab, with
	"format long". That gave for all three constants one digit more
	compared to old value (no change for already existing digits).

2012-03-16  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-33

	* tests/Wfuns/TestWfuns.arts: Updated according to changes in last
	commit.

2012-03-16  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-32

	* tests/GroundBased/TestGbased.arts: Added definition of lat_true.

	* src/m_jacobian.cc (jacobianCalcTemperaturePerturbations):
	Adopted call of z_fieldFromHSE, that required adding input vars.

	* includes/general.arts: Added definition of g0_agenda.

	* src/m_atmosphere.cc: Some methods moved to m_planets.cc.

	(z_fieldFromHSE): Now using g0_agenda, lat_true and lon_true.
	A first step to make the function more general.

	* src/m_planets.cc: New file, for planet specific workspace
	methods. Some WSM from m_atmosphere moved here.

	(g0Earth): New WSM.

	* src/agendas.cc: Added g0_agenda.

	* src/workspace.cc: New WSVs: g0, lat, lat_true, lon and lon_true.
	Text for lat_grid and lon_grid updated, now (again) saying that
	they must be set to be empty when not used.

2012-03-16  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-31

	* src/ppath.cc: Many changes. In summary: Several bug fixes.
	Tests removed from several functions, for things now handled by
	cart2XXX in a general way. Revision of refraction part finished.

	* src/ppath_NotUsed.cc (cart2poslos): Old version stored here.
	(cart2sph): Same here.

	* src/ppath.cc (plevel_slope_3d): cart2poslos was used when
	cart2pos suffices (where new version used).

	* src/montecarlo.cc (mcPathTraceIPA): Adopted to addition below.

	* src/geodetic.cc (cart2poslos,cart2sph): Made a version of the
	functions with additional input. The new input is information of
	the original position, used to improve the accuracy.

	* src/ppath.cc (plevel_crossing_2d): Now making use of absza also
	inside the function (as originally planned). DEBUG_ONLY then
	removed.

2012-03-15  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-30

	* src/m_abs.cc (abs_lines_per_speciesWriteToSplitArtscat):

	Don't crash for species that have no lines.

2012-03-08  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-29

	* src/methods.cc, src/m_abs.cc
	(abs_lines_per_speciesWriteToSplitArtscat):

	Add WSM to write a splitted ARTSCAT based on abs_lines_per_species.

	* src/xml_io_array_types.cc (xml_read_from_stream):

	Output some info to out2 about how many lines were actually read from
	the ARTSCAT. (read vs. total)

	* src/m_abs.cc (abs_linesReadFromArts):

	out2 output moved to xml_read_from_stream because there we have access
	to the total number of lines in the catalog.

	* src/parser.cc (ArtsParser::read_name_or_value):

	Throw a ParseError instead of plain runtime_error for unsupported
	parameter types. This way it outputs information about the line number
	in the controlfile.

	* src/ppath.cc (plevel_crossing_2d):

	Use DEBUG_ONLY macro for definition of absza.

	* src/math_funcs.cc (lgamma_func):

	Remove warning about value being floored to 1 if compiled with
	Numeric==float as we don't support float anymore.

	* src/arts.h, src/m_abs.cc, src/xml_io_array_types.cc:

	Change my "FIXME OLE:" to "FIXME: OLE:" so they're recognized by
	Xcode.

2012-03-14  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-28

	* src/ppath.cc (raytrace_2d_linear_euler): Correction for
	refraction got a negative length if abs(za) > 90.

	* doc/uguide/ppath_theory.tex: Removed some typos and sentences
	describing old stuff. Added a clarification about the unit used
	for the lat/lon gradient of refractive index. Better placement of
	figures.

2012-03-14  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-27

	* src/ppath.cc: Work on code for refraction. Now complete, and
	works in the case of n=1 with an accuarcy better than 1 mm.
	Not yet tested for n>1.

2012-03-13  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-26

	* src/ppath.cc: Code for refraction cleaned up and chenged. The
	old length interpolation removed as it deteriorates the accuracy
	and anyhow makes the code slower. A lot of changes caused by this.

	3D with refraction not yet ready!

	(interpolate_raytracing_points)
	(from_raytracingarrays_to_ppath_vectors_1d_and_2d)
	(from_raytracingarrays_to_ppath_vectors_3d):
	(ppath_fill_1d, ppath_fill_2d, ppath_fill_3d): Removed or merged
	into other functions.

	(ppath_end_1d,ppath_end_2d,ppath_end_3d): Now also making "fill"
	and handles vector lstep and nreal.

	* src/ppath_NotUsed.cc (refr_gradients_1d): Now placed here.

	* src/refraction.cc (get_refr_index_1d, get_refr_index_2d)
	(get_refr_index_3d, refr_gradients_2d, refr_gradients_3d):
	Converted rte_pressure, rte_temperature and rte_vmr_list from
	in/out/arguments to local variables (reminiscent from old agenda
	functionality).

2012-03-13  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-25

	* doc/uguide/ppath_theory.tex: Updated geomtrical 3D text to last
	changes.

	* src/ppath.cc: Resorted order of functions, to better seperate
	code for geometrical and refraction calculations.

	* src/ppath_NotUsed.cc (za_geom2other_point): Now placed here.

2012-03-12  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-24

	* src/ppath.cc: Moved inactive parts to file below.

	* src/ppath_NotUsed.cc: New file. Storage for code from ppath.cc
	now not used.

2012-03-10  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-23

	* src/ppath.h: Moved RTOL and LATLONTOL to ppath.cc.

	* src/ppath.cc (do_gridcell_3d_byltest): Updated to new approach
	to handle tangent points. Then found a bug for path steps around
	tangent points for old code. "lstep" before and after tangent
	point not necessarily the same but function returned just a single
	value. Solved automatically by switch to new approach.

	Introduced LACC, and moved RTOL and LATLONTOL from ppath.h, as not
	used externally.

	* src/m_general.cc (Test): Removed old test code.

2012-03-09  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-22

	* src/rte.cc:
	* src/m_rte.cc:
	* src/m_general.cc (Print):
	* src/m_fos.cc:
	* src/doit.cc:
	* src/ppath.cc:
	* src/xml_io_compound_types.cc: Adopted to change below.

	* src/ppath.h: Changed back: l_step -> lstep and l_space -> lspace
	(to be consistent with the WSV ppath_lmax/raytrace).

	* doc/uguide/batch.tex: Updated the code example where
	ppath_stepGeometric is re-defined.

	* doc/uguide/rte.tex: Updated regarding that sensor_pos now holds
	altitude instead of radius.

	* doc/uguide/ppath.tex: A quick re-revision. Some less important
	comments removed.

	* doc/uguide/atmosphere.tex: Some text improvements and updates.

	* src/geodetic.cc: Geiod -> ellipsoid in header.

	* src/ppath.cc: Part around PTILTMAX changed. Some more work on 3D
	code.

	* src/ppath.h: Removed version of plevel_slope_3d not used outside
	of ppath.cc. Removed PTILTMAX. Was just used in one place.

2012-03-07  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-21

	* src/ppath.cc (lat_crossing_3d, r_crossing_3d): Yet another
	version for selection between l1 and l2.

2012-03-05  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-20

	* src/ppath.cc (ppath_step_geom_3d): Now handling tangent points
	in the same way as 1D and 2D functions.

	(r_crossing_3d): Added special handling of r_hit==r_start.

2012-03-05  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-19

	* src/ppath.cc (ppath_step_geom_3d): Forgot to switch back to old
	version of do_gridcell_3d. (Now checks run with OK.)

2012-03-05  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-18

	* src/ppath.cc (r_crossing_3d, lat_crossing_3d, lon_crossing_3d):
	Now complete versions.

2012-02-29  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-17

	* src/ppath.cc: Some work on new 3D code.

	(lat_crossing_3d,lon_crossing_3d): New functions. Not yet complete.

2012-02-28  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-16

	* src/m_abs.cc (abs_linesReadFromSplitArtscat):

	If basename is a directory (path ends with '/'), don't append
	'.SPECIES.xml' but just 'SPECIES.xml'.

	* src/xml_io_array_types.cc (xml_read_from_stream):

	Fix regression for reading ArrayOfLineRecord from an ARTS catalog whose
	version number is just "3" instead of "ARTSCAT-3".

	(xml_write_to_stream): When writing an ArrayOfLineRecord, determine
	the required catalog version from the first LineRecord. If the array
	contains a mixture of different versions of lines, throw a runtime
	error.

	* src/xml_io.cc (xml_read_from_file,
	xml_read_arts_catalogue_from_file):

	Output the _full_ filename to out2. Gives better feedback to the user
	if the file is found somewhere in the path (ARTS_DATA_PATH) instead of
	the current directory.

2012-02-28  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-15

	* ChangeLog: Was not saved at last commit.

2012-02-28  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-14

	* doc/uguide/ppath_theory.tex: Revision and extending general part
	of 3D geometrical calculations.

	* src/ppath.cc (gridcell_crossing_3d): Extracted this function
	from arts-1-1-400, for later use (now inside /* */).

	* src/geodetic.cc (cart2poslos): Just rearrangement to get dy and
	dz terms in logical order.

2012-02-27  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-13

	* src/ppath.cc (do_gridcell_3d_byltest): Old do_gridcell_3d renamed.

	(plevel_crossing_3d): Started.

	(do_gridcell_3d): Started on this new version of the function.

2012-02-27  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-12

	* doc/uguide/ppath_theory.tex: General revision. Section on
	numerical precision removed. 2D geometrical section updated
	following changes in source code.

	* doc/uguide/ppath.tex: Even more sections moved to ATD. Text
	revised and updated.

	* src/xml_io_compound_types.cc:
	* src/m_general.cc:
	* src/ppath.cc (ppath_calc): Adopted to change below.

	* src/ppath.h (struct Ppath): Renamed lspace to l_space (to be
	consistent with l_space).

2012-02-24  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-11

	* A first step of moving all path equations to ATD.

	* doc/uguide/arts_theory.tex:
	* doc/uguide/CMakeLists.txt: ppath_theory.tex added.

	* doc/uguide/ppath_theory.tex: Holds the part removed below. Not
	yet adopted to ATD.

	* doc/uguide/ppath.tex: Last part having a lot of equations moved
	to ATD.

	* doc/uguide/surface.tex: First two section revised, and slightly
	changed.

2012-02-24  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-10

	* src/m_ppath.cc (ppath_stepGeometricUpDown): Now working with an
	active cloudbox (realised that this method can be used with DOIT
	1D, if ppath-step_agenda is changed after the cloudbox radiation
	field is determined)

	* src/ppath.cc (ppath_geom_updown_1d): Core part of change above
	done here.

	* src/ppath.cc (plevel_crossing_2d): Removed old version of this
	function.

	* src/geodetic.cc (geomtanpoint,geomtanpoint2d): Deactivated, as
	not yet known if result is OK:

	* src/ppath.h:
	* src/ppath.cc: All special treatment of float removed.

2012-02-24  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-9

	* aii, CMakeLists.txt: Remove outdated IDL routines.

2012-02-24  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-8

	* CMakeLists.txt: Add a very clear warning if the user decides to
	compile with a custom Numeric type.

2012-02-24  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-7

	* src/ppath.h: Changed RTOL to 1e-3, LATLONTOL to 1e-8 and POLELAT
	to 90-1e-8. These all corresponds to an overall accuracy of about 1
	mm (for Earth).

2012-02-23  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-6

	* tests/GroundBased/TestGbased.arts: The new WSM below is now used
	by this case.

	* src/m_ppath.cc (ppath_stepGeometricUpDown): New WSM. Provides
	much faster ppath calculations for 1D upward or downward cases.

	* src/ppath.cc (ppath_geom_updown_1d): New.

	* src/doit.cc:
	* src/m_doit.cc: z_surface removed as input to "update" methods,
	due to change below.

	* src/agendas.cc: Removed all input arguments beside ppath_step.

2012-02-23  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-5

	* src/parameters.{cc,h}:

	Add datapath to class Parameters.

	(parse_path_from_environment): Add function to parse paths from an
	environment variable.

	(get_parameters): Add option --datapath.

	* src/parser.cc (ArtsParser::parse_agenda):

	Pass includepath to find_file

	* src/main.cc (main): Add datapath output to -v.

	* src/file.{cc,h} (find_file): Add parameter paths.

	* src/xml_io.cc
	(xml_read_from_file,xml_read_arts_catalogue_from_file):

	Pass includepath and datapath to find_file.

2012-02-23  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-4

	* src/ppath.cc (rslope_crossing): Changed some limits for dlat.
	Using atmlab's arts_rslope_crossing, the function is OK-ed again.

	(plevel_crossing_2d): Added more asserts. Tested the new two step
	algorithm using atmlab's arts_rslope_crossing. Could not find any
	case where the algorithm fails (considering that the maximum
	radius distance for rslope_crossing now is (lat3-lat1)*c).

2012-02-22  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-1-3

	* src/ppath.cc (ppath_step_geom_1d): Had to reinroduce handling of
	tangent points on this level. It was here for a good reason that I
	forgot (to also handle DOIT). Tangent points now flagged as endface
	8. Same change for 2D.

2012-02-22  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-2

	* src/libmicrohttpd/:

	Update to r19912 from https://gnunet.org/svn/libmicrohttpd.

	* CMakeLists.txt, src/libmicrohttpd/CMakeLists.txt:

	Tweak warning flags for Clang compiler, and libmicrohttpd.

2012-02-22  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-1

	* Merge arts-dev branch r7344 into trunk.

2012-02-22  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-0dev1

	* ChangeLog: Remove conflict marker.

2012-02-22  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-0dev0

	* Merged from trunk r7341.

2012-02-22  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-1-0

	* Increase minor version after branching.

2012-02-22  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-38dev4

	* src/ppath.cc (ppath_calc): lspace was not transfered to final
	ppath. Polishing of new code for 1D and 2D geomtric.

	* src/xml_io_compound_types.cc: Ppath constant was saved as
	lspace!

2012-02-20  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-38dev3

	* make check and make check-fast now run with OK.

	* tests/*/*.arts:
	* includes/*/*.arts: All control files adopted to changes made
	around refellipsoid and ppath.

	* tests/testall.py (TestClearSky.test3): Changed target Tb for
	ClearSky case. This was needed as the Earth radius in constants.cc
	has been changed. Verified that old target Tb was obtained with
	old radius (so no change in RT part).

	Down-looking cases less affected by the changed radius, but could
	now be a slight shift with respect to old target values (if za <
	180).

2012-02-20  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-38dev2

	* src/ppath.cc (ppath_copy): Did not work for l_step if ppath2.np=1.

	* src/ppath.cc (ppath_calc): The case of single point ppaths now
	handled seperately when creating the final ppath. The merging of
	ppath_array could then be made somewhat more efficient, and solves
	a problem of getting nreal into the first point of final ppath.

	* src/m_ppath.cc (ppath_stepGeometric): Now sets nreal to 1. This
	solves nreal for geometrical calculations (after the changes above).

2012-02-19  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-38dev1

	* src/ppath.cc (ppath_calc): Added handling of Ppath.lspace and
	Ppath.nreal. lspace calculated, but nreal not yet set.

	* src/m_general.cc (Print):
	* src/xml_io_compound_types.cc (xml_write_to_stream): Added
	handling of Ppath.lspace, and adopted to changed field order.

	* src/ppath.h (struct Ppath): Added field lspace. Needed to
	keep track of complte ppath length/delay. Changed order of fields.

	* src/ppath.cc (rslope_crossing): New function. Just performing
	core task of old plevel_crossing_2d (finding the crossing with a
	level having radial slope).

	(plevel_crossing_2d): New version of this function, with extended
	scope. It now handles all tasks around checking if there is a
	crossing inside the latitude grid range. The accuracy also
	improved, as the Taylor expansion expression is now only used for
	a final smaller step. Exact expressions are used in a first step,
	moving the ppath as close as possible to the surface before the
	approximative expression is applied.

	(do_gridcell_2dv2): New version of do_gridcell_2d, making use of
	the functions above. All this recoding done with the aim to later
	use the same calculation approach, and function structures, for 3D.

2012-02-20  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-38dev0

	* Merged from trunk r7321.

2012-02-20  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-38

	* src/m_abs.cc (abs_linesReadFromSplitArtscat):

	Use species ids instead of strings.

	* src/xml_io.cc: Comment out unused variable.

2012-02-17  Gerrit Holl  <gerrit.holl@ltu.se>

	* arts-2-0-37

	* src/m_cloudbox.cc (pnd_fieldSetup): bugfix
		- Fix fixed bug from arts-1-17-25, set pnd = dN if monodisperse

2012-02-17  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-36

	* CMakeLists.txt: Turn off -Wno-sign-conversion for now. It's not
	supported by older GCCs.

2012-02-17  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-35

	* CMakeLists.txt: Turn on -Wconversion warning by default.

	* src/m_cloudbox.cc:
	(cloudboxSetAutomatically): Change type of p_margin1 from Index to
	Numeric to avoid loss of precision in implicit cast.

	(ScatteringParticlesSelect): Change type of intarr_total from Numeric
	to Index.

	* src/docserver.cc (Docserver::launch): Cast port to uint16_t.

	* src/math_funcs.cc, src/m_abs_lookup.cc, src/m_surface.cc:

	Add some explicit casts from Index to Numeric to suppress conversion
	warning for cases where we know what we're doing.

	* src/nc_io_array_types.cc: Remove unused variables.

	* src/libmicrohttpd/daemon.c (send_param_adapter): Add explicit cast
	to avoid conversion warning.

2012-02-14  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-34

	* src/m_abs.cc (abs_linesReadFromSplitArtscat):

	Use isdigit instead of isnumber for compatibility.

2012-02-14  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-33

	* src/m_abs.cc (abs_linesReadFromSplitArtscat):

	First implementation. For abs_species with an isotope that's not a
	number or '*', no catalog is read.

	* src/methods.cc: Add WSM abs_linesReadFromSplitArtscat.

2012-02-14  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-32

	* src/xml_io_array_types.cc:

	Combine the almost identical functions for reading an
	ArrayOfLineRecord with and without frequency limits into one function.
	Setting the limits fmin and/or fmax to NAN indicates to not filter by
	frequency.

	* src/parameters.cc (get_parameters):

	Use consistent conversion error checking on isstringstreams.

2012-02-13  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-31

	* src/absorption.{cc,h}:

	Add new ARTSCAT-4 fields to LineRecord.

	Add support for ARTSCAT-4 in LineRecord output operator.

	(LineRecord::ReadFromArtscat4Stream): Implemented.

2012-01-30  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-30

	* Preparations for ARTSCAT-4.

	* src/absorption.{cc,h}:

	Rename LineRecord::Version to LineRecord::VersionString. Version() now
	returns the version number as an Index.

	Rename LineRecord::ReadFromArtsStream to
	LineRecord::ReadFromArtscat3Stream and add
	LineRecord::ReadFromArtscat4Stream (copy of LR:RFA3S for now).

	* src/xml_io_array_types.cc (xml_read_from_stream):

	Adapt ArrayOfLineRecord reading routine to detect ARTSCAT version and
	call corresponding LR:ReadFromArtscatXStream function.

	* src/m_abs.cc (abs_linesReadFromArtsObsolete): Adapt for name changes.

2012-02-08  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-0-29

	* src/ppath.cc:

	bugfix (cloudbox reaching to TOA -> first ppath instance sees
	background, don't try to iterate along path).

2012-02-18  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev15

	* tests/Ppath/TestPpath3D.arts: Was not svn-added.

2012-02-18  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev14

	* src/ppath.cc (r_crossing_2d): New function.

	* src/agendas.cc: p_grid now not input to ppath_step_agenda.
	Required adoption in several files. 
	
	* src/m_ppath.cc (ppath_stepGeometric): Adopted calls of
	sub-functions. p_grid now not used.

	* src/doit.cc (ppath_step_in_cloudbox): Removed this function. Not
	used at all!

	* src/ppath.cc: Changes throughout the file with respect to tangent
	points. The ppath fields now not set. Tangent points now not
	handled as an "endface", but handled one level lower among the
	sub-functions (now at the level of do_gridrange_1d level).
	Requires less shuffling of data and cleaner code.

	* src/m_montecarlo.cc (MCIPA): Lat and lon of tangent point now
	determined from ppath.pos.

	* src/m_general.cc: 
	* src/xml_io_compound_types.cc: Adopted to change of Pppath. 

	* src/ppath.h (struct Ppath): Removed field tan_pos, geom_tan_pos and
	next_parts.

	* src/ppath.cc (ppath_start_stepping): More tests. Fixed one bug
	and now demanding that platform radius is > r_toa_max. Handling of
	2D and 3D now even more similar.

	* tests/Ppath/TestPpath3D.arts: New.

2012-02-17  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev13

	* src/ppath.cc (plevel_crossing_3d): Renamed to r_crossing_3d as
	task of function has been changed. Header text described the
	original version.

	* src/ppath.cc (ppath_start_stepping): Some improvements of the
	code for finding TOA entrance point for 2D.
	Complete new code for 3D. Not yet tested heavily.

2012-02-16  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev12

	* tests/Ppath: Start on a set of new test control files.

	* src/ppath.cc: Corrected errors in several headers.
	Corrected/changed text for several errors.
	
	(geompath_za_at_r): Sign of za was not kept if r==ppc! 

	(ppath_start_stepping): Code 2D now revised and using a new
	algorithm for finding entrance point at TOA.
	(Full 1D and 2D ppath calculations tested quite carefully.)

	* src/m_cloudbox.cc (cloudbox_checkedCalc): Polished error message.

	* src/m_basic_types.cc (IndexStepDown, IndexStepUp): New WSMs.
	(IndexStep): Replaced by IndexStepUp.
	
2012-02-15  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev11

	* src/geodetic.cc (poslos2cart): Added assert for za.

2012-02-13  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev10

	* src/geodetic.cc (geomtanpoint2d): New. Not yet complete.

	* src/ppath.cc (ppath_start_stepping): A complete revision of the
	function, to use same basic approach for 1D, 2D and 3D. And to add
	some missing parts (cloudbox in 2D, cloudbox reaching TOA ...).
	Code for 2D presently not complete.

	* src/geodetic.cc (poslos2cart): Now not calling sph2cart, to save
	some time (code instead copied and adopted).

	* src/geodetic.cc (geomtanpoint): New function. Calculates the
	geomtrical tangent altitude, also for non-spherical planets.

	* src/constants.cc: Changed EARTH_RADIUS from 6.378e6 to 6.3781e6,
	which seems to be the standard value.

	* src/math_funcs.cc (cross): A function for 3D cross product. 
	(unitl): New function. Normalises a vector.
	
2012-02-10  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev9

	* Change to a more common defintion of the cartesian coordinate
	system made. 

	* src/ppath.cc: Functions listed below removed.
	(plevel_crossing_3d): Here y <-> z change needed.

	* src/geodetic.cc: cart2poslos, cart2sph, geompath_tanpos_3d,
	poslos2cart and sph2cart, now placed in this file. Cartesian y and
	z axes have changed place inside these functions, to follow a more
	standard cartesian coordinate system.

2012-02-10  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev8

	* Code now updated following changes around refellipsoid and
	sensor_pos/rte_los. Made basic tests, but no heavy testing. This
	will be done after ppath_start_stepping is finished.

	* src/m_general.cc (Print): Adopted printing for Ppath.

	* src/ppath.h: Removed field z from Ppath structure.

	* src/montecarlo.cc (mcPathTraceIPA): Adopted to change for
	rte_pos (now holding altitude, not radius). Seems to be only
	needed change for all MC code, with respect to this point.

	* src/m_doit.cc (CloudboxGetIncoming, CloudboxGetIncoming1DAtm):
	Removed refellipsoid as input, now not used.

	* src/m_doit.cc (doit_i_fieldUpdateSeq1DPP):
	* src/doit.cc (cloud_ppath_update1D_planeparallel): Removed not
	used input arguments ppath_step_agenda and refellipsoid. Adopted
	to changes of pos definition.

	* src/ppath.cc (ppath_start_stepping): Now fixed and tested for 3D.

2012-02-10  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev7

	* src/ppath.cc (ppath_start_stepping): Updated for 3D.

2012-02-09  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev6

	* src/ppath.cc: 2D geomtric cases revised. 1D and 2D geometric
	tested. Started on 3D.

	* src/geodetic.cc (refell2d): New function.

2012-02-09  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev5

	* Work in progress. Transfer from lap- to desktop. Does not compile!

	* src/ppath.cc: Being revised.

	* src/xml_io_compound_types.cc (xml_write_to_stream): ppath.z ->
	ppath.r.

	* src/ppath.h (struct Ppath): Field z renamed to r.

	* src/m_ppath.cc: File revised with respect to new WSV definitions.
	(VectorZtanToZa1D): Adopted to new definition of sensor_pos.
	(VectorZtanToZaRefr1D): As above.

	* tests/OdinSMR/TestOdinSMR.arts:
	* tests/OdinSMR/TestOdinSMR_119ghz.arts: Removed call of
	sensor_posAddRgeoid.

	* includes/general.arts: refellipsoid now set (instead of r_geoid).

2012-02-08  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev4

	* src/: r_geoid and the term geoid wiped out from the source code!
	Numerous changes to make the change to refellipsoid, affecting a
	high number of files.

	The code compiles, but no test calculations yet made.

	* src/m_surface.cc (r_geoidSpherical, r_geoidWGS84): Removed.

	* src/workspace.cc: r_geoid removed.

	* src/m_ppath.cc (rte_posAddRgeoid): Removed. Sensor position will
	be given as altitude above ellipsoid (future change).
	(sensor_posAddRgeoid): As above.

	* src/m_ppath.cc (ppathCalc): Now considers basics_checked and
	cloudbox_checked.

	* src/m_atmosphere.cc (basics_checkedCalc): The method now checks
	refellipsoid instead of r_geoid.

2012-02-08  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev3

	* doc/uguide/concept.tex: Rewrote item point including "geoid".

	* doc/uguide/surface.tex: Revised, following the change from
	r_geoid to refellipsoid.

	* doc/uguide/atmosphere.tex: Revised up to Sec. 2.5, following
	changes made/planned. The view of 1D and 2D atmospheres slightly
	changed. For 1D, the sensor is now consider to be placed at
	lat/lon=0, and be looking North. For 2D, the plane is now "locked"
	to pass above the poles, and lat=0 is at the Equator (but no upper
	or lower limit as before). This definition is needed for 2D to
	have a relationship to the reference ellipsoid.

	* src/check_input.cc (chk_atm_grids): Changed back to demand that
	lat_grid and lon_grid are empty when not used. Variables like
	"lat_true" and "lon_true" will be introduced to geographically
	place 1D and 2D cases.

2012-02-07  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev2

	* src/geodetic.cc (refell2r): New function.

	* src/m_geodetic.cc (refellipsoidForAzimuth):  New WSM.
	(refellipsoidOrbitPlane): New WSM.

2012-02-07  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-28dev1

	* src/m_geodetic.cc:
	(refellipsoidEarth, refellipsoidJupiter, refellipsoidMars)
	(refellipsoidSet, refellipsoidMoon, refellipsoidVenus): New WSMs.

	* src/surface.cc: Moved internal functions before placed in
	m_surface to this file.

	* src/CMakeLists.txt: Added the new files listed below.

	* src/geodetic.h:
	* src/geodetic.cc:
	* src/m_geodetic.cc:
	* src/surface.h:
	* src/surface.cc: New files.

	* src/*: Removed all remaining rss. in my email address.

	* src/workspace.cc: Added refellipsoid.

	* TODO: Will be using this file for notes.

2012-02-06  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-28dev0

	Merged from trunk r7263.

2012-01-30  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-28

	* Fix compilation against the new libc++ http://libcxx.llvm.org/

	* src/xml_io.cc (xml_read_header_from_stream): Use ' ' as delimiter.

	* src/m_general.cc: Include arts.h before using TIME_SUPPORT.

	* src/src/file.cc:

	Include arts.h first and include unistd.h (for 'unlink' function) if
	available.

2012-01-26  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-27

	* src/continua.cc: Add two missing throws for runtime errors.

2012-01-20  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-26

	* src/m_optproperties.cc:

	Make all preprocessor macros UPPERCASE. Otherwise the code gets
	horribly unreadable. If they appear just as normal variables it's
	very hard to guess that they're actually macros.

	Macros changed: PART_TYPE F_DATAGRID T_DATAGRID ZA_DATAGRID AA_DATAGRID
	PHA_MAT_DATA_RAW EXT_MAT_DATA_RAW ABS_VEC_DATA_RAW PND_LIMIT

2012-01-09  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-25

	* CMakeLists.txt: Add cmake option -DWITH_GUI=1.

	* src/CMakeLists.txt:

	Detect Qt libraries, link with artsgui lib and add gui subdirectory if
	enabled.

	* src/parameters.{cc,h}: Add -G (--gui) option to launch with GUI.

	* src/main.cc: Add GUI launch code.

	* src/gui/: Add subdirectory for arts GUI library code.

	* src/gui/CMakeLists.txt, src/src/gui/ag_main.{cc,h},
	src/gui/mainwindow_qobj.{cc,h}:

	Simple main window with helloworld message.

	* config.h.cmake: Add ENABLE_GUI preprocessor flag.

	* src/continua.cc: Initialize jsum with 0 to avoid warning.

2011-12-07  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-24dev0

	Merged from trunk r7223.

2011-12-07  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-24

	* src/arts_omp.cc (arts_omp_in_parallel):

	No more special treatment needed for Intel Compiler.

2011-11-24  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-23

	* CMakeLists.txt:

	Add an additional check right at the beginning to make sure that we
	never allow cmake to be called inside the source directory.

	NOTE: If you get an error after updating that you have to build
	arts outside the source tree although you are actually in a separate
	build directory, make sure that there is no file 'CMakeCache.txt' or
	directory 'CMakeFiles' in your toplevel arts source(!!) directory.

	* tests/testall.py: Fix path to arts for Xcode build.

	* src/docserver.cc (insert_breadcrumbs): Fix type of t, int -> size_t.

2011-11-23  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-22

	* doc/uguide/symbol_defs.tex: More definitions around refrcative
	index. Some consistency changes.

	* doc/uguide/rte.tex: Planck function equation now uses symbol
	definitions throughout.

2011-11-22  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-21

	* doc/uguide/rte.tex: New symbol definitions used.

	* doc/uguide/symbol_defs.tex: Added definitions for Stokes elements
	I, Q, U and V, and speed.

2011-11-18  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-20dev0

	* Created development branch from trunk r7212.

2011-11-11  Gerrit Holl <gerrit.holl@ltu.se>

	* arts-2-0-20

	* src/m_abs_lookup.cc (abs_lookupCreate): Improve error message.

2011-11-07  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-19

	* src/ppath.cc (ppath_start_stepping): Now also "upward"
	observations are allowed when the sensor is above the model
	atmosphere. The idea is to allow the cloudbox to include TOA.

2011-11-05  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-0-18

	* src/cloudbox.cc:

	(IWCtopnd_MH97): for large IWC (obviously outside the original
	parameterization range) number densities in small particle mode got
	negative. now, if so, explicitly set to 0. though not specified by MH97,
	this should be fine, since even the small mode rather creates particles
	with Dm>100um, which should be covered by the large mode.

2011-11-05  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-0-17

	* src/cloudbox.cc:

	(IWCtopnd_MH97): bugfix. cases with all ice in <100um mode (lowT &
	small IWC) lead to NaN at >100um mode lead to all pnd set to 0. now
	producing proper pnd_field (relevant more for IR than MW, I guess).

	(chk_pndsum): bugfixed interface, where vol and density where swapped.
	modified pnd scaling correction - don't let pnd==0 slip through, when
	xwc!=0, so rather test for xwc==0 instead of x.sum()==0. potentially
	caused huge deviations that went uncatched...

	* src/cloudbox.cc: corresponding chk_pndsum interface adaption.


2011-11-02  Daniel Kreyling <daniel.kreyling@nict.go.jp>

	* arts 2-0-16

	* src/m_cloudbox.cc: (pnd_fieldSetup) Added new globally
	applicable particle size distribution for ice and snow particles,
	based on the work of A.J. Heymsfield (apparently not published
	yet). In ARTS terms the new PSD is called 'H11' and can be used
	for scattering calculations just like 'MH97'.

	* src/cloudbox.cc (pnd_H11): new function to evaluate the
	distribution at given scattering particle sizes
	(scale_H11): scaling the 'H11' PND values to total ice or snow
	massdensity.

	*src/methods.cc: updated doku for 'H11'

	*src/workspace.cc: updated doku for 'H11'


2011-10-27  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-0-15

	* src/methods.cc,agendas.cc,workspace.cc: more broken doc links fixed

2011-10-27  Jana Mendrok <jana.mendrok@ltu.se>

	* arts-2-0-14

	* src/methods.cc: fixed some doxygen doc (references to workspace
	methods/variables)

	* includes/smr: added sensor definitions for ciwsir, cloudice, iss-smr,
	(jaxa-)smr

2011-10-17  Stefan Buehler  <sbuehler(at)ltu.se>

	* arts-2-0-13

	* src/absorption.h (LineRecord): Updated doxygen documentation for
	this class. (Basically added information on the XML header and
	footer.) Triggered by Agnes asking about a description of the ARTS
	catalogue format.

2011-10-04  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-12

	* src/agendas.cc: Ooops, don't fix it if it ain't broken.

2011-10-04  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-11

	* src/docserver.{cc,h}:

	Mark broken *LINKS* red.

	Add a 'Doc check' page that lists all broken links. Add link to this
	page in footer.

	(insert_breadcrumb_token, insert_breadcrumbs): Fix broken breadcrumbs.

	(description_add_links): Also search through GIn and GOut to determine
	if *LINK* target exists.

	* src/methods.cc:

	Put space around * if used as multiplication operator in docs.

	* src/agendas.cc: Minor doc fix.

2011-09-11  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-10

	* src/m_rte.cc (yCalc2): Some bug fixes. Changes needed elsewhere
	before a switch to this version cen be made. 

2011-09-15  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-9

	* CMakeLists.txt: Provide some love for Cygwin users.

2011-09-15  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-8

	* src/m_basic_types.cc (ArrayOfIndexSetConstant): Created.

	* src/m_sensor.cc (sensor_responseFromArrayData): Created.
	(sensor_response_arraySingle): Created.

	* src/workspace.cc: Introduced sensor_response_array, 
	sensor_response_index, sensor_response_f_array,
	sensor_response_pol_array, sensor_response_za_array and
	sensor_response_aa_array

2011-09-14  Gerrit Holl  <gerrit.holl@ltu.se>

	* arts-2-0-7

	* src/m_montecarlo.cc(MCGeneral): Bugfix
	  - Move check for g==0 to outside if...else block checking for
	    different scenarios; this is problematic in any case.

	* src/montecarlo.cc(mcPathTraceGeneral): Bugfix
	  - Don't calculate log(exp(very_negative_number)), result might
	    become 0, causing problems later. Use the very_negative_number
		directly instead.

2011-09-11  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-6

	* src/agendas.cc: Added sensor_response_agenda. 

	* src/m_rte.cc (yCalc2): A version of yCalc using
	sensor_response_agenda. Not yet activated (just backup of the
	coding so far).

2011-09-09  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-5

	* src/matpackII.cc:

	Fix bug in Sparse copy constructor. Crashed when trying to copy empty
	Sparse matrices.

	* src/xml_io_instantiation.h, src/array.h, src/xml_io_array_types.cc,
	src/xml_io_types.h, src/groups.cc, src/nc_io_array_types.cc:

	Add ArrayOfSparse.

2011-09-08  Gerrit Holl  <gerrit.holl@ltu.se>

	* arts-2-0-4

	* src/m_montecarlo.cc (MCGeneral): Bugfix
	  
	  - If the lowest layer has large extent and a thick cloud, g may be 0
	  due to underflow, but then I_i should be 0 as well.  Don't turn it
	  into nan for no reason!

2011-09-08  Patrick Eriksson  <patrick.eriksson@chalmers.se>

	* arts-2-0-3

	* src/m_jacobian.cc (jacobianCalcPolyfit): Improved error message.

2011-09-05  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-2

	* src/arts.{h,cc}:

	Add ArtsOut parameter to arts_exit_with_error_message and
	exit_or_rethrow. Fixes a bug reported by Gerrit where runtime error
	output only ended up on stderr but was missing from the rep file.

	* src/main.cc,
	src/m_atmosphere.cc (batch_atm_fields_compactFromArrayOfMatrix),
	src/m_agenda.cc (Arts, Arts2), src/absorption.{h,cc} (xsec_species),
	src/m_abs_lookup.cc (abs_lookupCreate), src/m_batch.cc (ybatchCalc):

	Pass out0 to arts_exit_with_error_message and exit_or_rethrow.

	* src/m_abs.cc (abs_xsec_per_speciesAddLines),
	src/absorption.{h,cc} (xsec_species), 

	Add verbosity argument to xsec_species.

	* rte.{h,cc} (iyb_calc), src/m_jacobian.cc:

	Add verbosity argument to iyb_calc.

	* src/groups.cc (get_wsv_group_ids): Removed unused variable it.

	* doc/arts-splash.gif: Remove 'pre2.0'.

2011-09-05  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-1

	* src/arts.h: Change ARTS-1-1-x -> ARTS-2 in doc header.

	* src/docserver.{cc,h}, src/main.cc: Refactor docserver into a class.

	* src/methods.h, src/methods_aux.cc:

	Add declarations for format_paragraph and get_short_wsv_description.

2011-09-02  Oliver Lemke  <olemke@core-dump.info>

	* arts-2-0-0

	* ChangeLog: ARTS-2 release!

