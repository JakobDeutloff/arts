%
% To start the document, use
%  \levela{...}
% For lover level, sections use
%  \levelb{...}
%  \levelc{...}
%
\levela{The forward model: concepts, definitions and overview}
 \label{sec:fm_defs}

%
% Document history, format:
%  \starthistory
%    date1 & text .... \\
%    date2 & text .... \\
%    ....
%  \stophistory
%
\starthistory
  020314 & Layout made by Patrick Eriksson.\\
\stophistory


%
% Symbol table, format:
%  \startsymbols
%    ... & \verb|...| & text ... \\
%    ... & \verb|...| & text ... \\
%    ....
%  \stopsymbols
%
%
\startsymbols
  \Ind           & -                 & vector/matrix/tensor index           \\
  \aInd{\Lat}    & -                 & the \Ind:th latitude                 \\
  \VctLng        & -                 & vector length or size of matrix/tensor for a dimension \\
  \aVctLng{\Lat} & -                 & length of the latitude grid \\
  \Prs           & \verb|p|          & pressure                             \\
  \PrsAlt        & \verb|pz|         & pressure altitude                    \\
  \Rds           & \verb|r|          & radius from the centre of the coordinate system         \\
  \Alt           & \verb|z|          & geometrical altitude above the geoid \\
  \Lat           & \verb|alpha|      & latitude                             \\
  \Lon           & \verb|beta|       & longitude                            \\
  \ZntAng        & \verb|psi|        & zenith angle                         \\
  \AzmAng        & \verb|omega|      & azimuthal angle                      \\
 \label{symtable:fm_defs}     
\stopsymbols



This chapter introduces terms and concepts of ARTS as a forward model,
in contrast to the previous chapter that describes ARTS as a computer
programme. While the content of the previous chapter is specific for
ARTS, as the way to use a forward model programme differ normally
significantly from one implementation to another, this chapter is of
more general nature. Most of the quantities treated here should be
part of any forward model of the same complexity as ARTS, where only
details regarding the definition should differ. The aim of this
chapter is to give an overview of the forward model and to describe
important terms and concepts, in such way that, the content of this user
guide can be fully appreciated and that you shall understand how to
generate a control file for your simulation problem.



\levelb{Mathematics}
%==============================================================================
\label{sec:fm_defs:math}

[* A short introduction to the vectors, matrices and tensors should be
found here. It should be described what the terms means, the order in
which dimensions are given, how sizes are specified here in the guide,
how different dimensionalities are handled etc. 

Shall we use round braces for specifying a value, e.g.
\begin{equation}
  \Alt(\aInd{\Lon},\aInd{\Lat},\aInd{\Prs})
\end{equation}
and square braces for giving the size:
\begin{equation}
  \Alt \SzeSmb [\aVctLng{\Lon},\aVctLng{\Lat},\aVctLng{\Prs}]
\end{equation}
(is the \SzeSmb\ the correct symbol to use here?)? To not confuse
ourselves, we should use the same dimension order as inside ARTS, or? 

SAB: Ok to the round an square braces. How about 1-based / 0-based
indexing? Would it be possible to use 0-based also in the text. Would
be less confusing.

Certainly yes to take care that the dimension order is the same in
Program and Uguide. Hm, maybe there is still need for discussion here,
see remark in the text, marked by (*). I think if we have an object of
type (a,b,c), it will be very confusing to speak of 'c' as the first
dimension. This is true neither for program, nor for documentation,
'a' comes first! But 'a' is the *outermost* dimension here.

Should we avoid numbers and speak of the page dimension, row
dimension, and column dimension in this case? 

(**) Another thing: I find the ordering of the spatial dimensions just
confusing. (Don't kill me.) If the dimensions are fixed, the order is
really arbitrary, pure definition.  What if we overthrow our old
decision and make the order:

\begin{verbatim}
Dimemensions of some important variables:

Position: p, alpha, beta, as needed.

Atmospheric fields (like t_field): Tensor3(p,alpha,beta)

Grids: p_grid, alpha_grid, beta_grid

Radiation field:  (p,lat,lon,phi,omega,f,S)
(Scalar 1-d case: (p,  1,  1,phi,    1,f,1))
(That's a one there, f is frequency, S is the index of the Stokes
component (0-3).)

To define a line of sight: Vector(5)(p,lat,lon,phi,omega)
\end{verbatim}

I find this somewhat more intuitive, and it has the advantage that for
sensor\_pos and sensor\_los you can give just the required number of
columns, starting with p or phi. (See also remark there.)

*]



\levelb{The atmosphere}
%==============================================================================
\label{sec:fm_defs:atmosphere}


\levelc{Atmospheric dimensionality}
%===================
\label{sec:fm_defs:atmdim}

The structure of the atmosphere can be defined to have different
degree of complexity, the \qindex{atmospheric dimensionality}. There
exist three levels for the complexity of the atmosphere, 1D, 2D and
3D, where 1D and 2D can be treated as special cases of 3D. The
significance of these different atmospheric dimensionalities [* does
this form of the word exist? SAB: I don't know a better word, so leave
it. *], and the coordinate systems used, are
here described.

\leveld{\qindex{3D}} In this, the most general, case, the
atmospheric fields vary in all three spatial coordinates, as in a true
atmosphere. A spherical coordinate system is used where the dimensions
are radius (\Rds), latitude (\Lat) and longitude (\Lon), and a
position is given as $(\Lon,\Lat,\Rds)$. With other words, the
standard way to specify a geographical position is followed. However,
the way to specify the radial position differs depending on the
context, which is described in Section~\ref{sec:fm_defs:altitudes}.
The valid range for latitudes goes from -90\degree to +90\degree,
where +90\degree corresponds to the North pole etc. Longitudes are
counted from the Greenwich meridian with positive values towards the
east. The meridian at the Greenwich antipode has longitude +180\degree
and longitudes smaller or equal to -180\degree are not allowed. The
poles are considered to be placed at longitude 0\degree. [* SAB: I
don't understand this last sentence. Aren't the poles at all
longitudes? *]

\leveld{\qindex{1D}} A 1D atmosphere can be described as being
spherically symmetric. The term 1D is used here for simplicity and
historical reasons, not because it is a true 1D case (a strictly 1D
atmosphere would just extend along a line). A spherical symmetry means
that atmospheric fields and the ground extend in all three dimensions,
but they have no latitude and longitude variation. This means that,
for example, atmospheric fields vary only as a function of altitude
and the ground constitutes the surface of a sphere. The radial
coordinate is accordingly sufficient when dealing with atmospheric
quantities, but the angular distance between the sensor and a point
along the propagation path can be of interest, for example when
determining the cross-link between two satellites (a fact that shows
that this is not a true 1D case). A polar coordinate system is for
this reason used when describing propagation paths, where the
coordinate additional to the radius gives the angular distance inside
the viewing plane between the sensor and the point of interest (see
further Section~[**]).  This latter coordinate system coincides with
the one used for 2D where the sensor position is set to be the zero
point for latitude. A 1D atmosphere is shown in
Figure~\ref{fig:fm_defs:1d}.

\leveld{\qindex{2D}} In contrast to the 1D and 3D cases, a 2D
atmosphere extends only inside a plane. A spherical coordinate system
is accordingly not needed and a polar system, consisting of a radial
and an angular coordinate, is used. The 2D case is most likely used
for satellite measurements where the atmosphere is observed inside the
orbit plane. The angular coordinate corresponds then to the angular
distance along the satellite track [* is this a clear description?
SAB: Yes, I think it is clear. *], but the coordinate is for
simplicity denoted as the latitude. The zero point for the 2D latitude
is arbitrary. No lower and upper limit exists for the 2D latitude, and
this allows that measurements from several subsequent orbits can be
simulated as one unit. The atmosphere is treated to be undefined
outside the considered plane. A 2D atmosphere is shown in
Figure~\ref{fig:fm_defs:2d}.

 \begin{figure}[!t]
  \begin{center}
   \includegraphics*[width=0.95\hsize]{Figs/atm_dim_1d}
   \caption{ A schematic cross-section of a 1D atmosphere. The atmosphere is 
     here spherically symmetric. This means that the radius of the
     geoid, the ground and all the pressure surfaces is constant. The
     cloud box extends from the ground up to the thin solid line. The
     upper limit of the cloud box coincides always with a pressure
     surface.  }
   \label{fig:fm_defs:1d}  
  \end{center}
 \end{figure}
 % This figure was produced by the Matlab function mkfigs_atm_dims.

 \begin{figure}[!t]
  \begin{center}
   \includegraphics*[width=0.95\hsize]{Figs/atm_dim_2d}
   \caption{ Schematic of a 2D atmosphere. The radii of the geoid, the ground
     and all the pressure surfaces are for 2D atmospheres allowed to have a
     latitude variation. The limits of
     the cloud box coincide always with grid box boundaries. Plotting
     symbols as in Figure~\ref{fig:fm_defs:1d}. }
   \label{fig:fm_defs:2d}
  \end{center}
 \end{figure}
 % This figure was produced by the Matlab function mkfigs_atm_dims.


\levelc{Altitude coordinates}
%===================
\label{sec:fm_defs:altitudes}

\leveld{Pressure \index{pressure} and \qindex{pressure altitude}} The
main altitude coordinate is pressure. This is most clearly manifested
by the fact that the vertical atmospheric grid consists of surfaces
with equal pressure.  The vertical grid is consistently denoted as the
pressure grid and the corresponding workspace variable is called
\verb|p_grid|. The choice of having pressure as main altitude
coordinate results in that atmospheric quantities are retrieved as a
function pressure, not as a function of geometrical altitude.

However, a basic assumption in ARTS is that atmospheric quantities
(temperature, geometric altitude, species VMR etc.) vary linear with
the logarithm of the pressure. This corresponds roughly to assuming a
linear variation with altitude. To obtain a more intuitive unit for the
logarithm of the pressure, the quantity pressure altitude, \PrsAlt, is
introduced, and it is defined as
\begin{equation}
  \PrsAlt = \aPrsAlt{s}(\log_{10}\aPrs{0} - \log_{10}\Prs)
 \label{eq:fm_defs:prsalt}
\end{equation}
where \aPrsAlt{s} and \aPrs{0} are arbitrary parameters (set in
\verb|arts.h|), but suitably selected in such way that the pressure
altitude corresponds roughly with the geometrical altitude. [* Values
around $\aPrsAlt{s}=1013$~hPa and $\aPrs{0}=15.5$~km are suitable for
simulations dealing with the Earth's atmosphere. SAB: P0 and pzs are
mixed up above. Also, why not mention that pzs is the scale height?
Suggested new version:

The two parameters correspond to the scale height and the surface
pressure, respectively. Values around $\aPrsAlt{s}=15.5$~km and
$\aPrs{0}=1013$~hPa are suitable for simulations dealing with the
Earth's atmosphere.

*]

[* According to what I have written, \verb|p_grid| is in pressure.
The question is if we shall have a parallel variable for the pressure
altitude, or if we shall make a repeated conversion of \verb|p_grid|
when needed? My guess is that it is not necessary to make this
conversion many times, partly as the interpolation weights are
pre-calculated by my index positions. What do you say? 

SAB: I fear that having two vertical variables that are alternatively
used would be a source of confusion and bugs. We should decide on one
of the two. Methods needing the other one should make an internal
conversion. I have no strong opinion which one is better. Pressure
seems more straight forward, though.

If I understand what you wrote correctly, you suggest that p\_grid
should be the vertical variable, and pz\_grid calculated only when
needed. If this is feasible without high cost, I think it is the best
solution.  *]

\leveld{Radius \index{radius}} Beside pressure, geometrical altitudes
are needed to determine the propagation path through the atmosphere
etc. The main geometrical altitude coordinate is the distance to the
centre of the coordinate system used, the radius. This is a natural
consequence of using a spherical or polar coordinate system. The
radius is used inside ARTS for all geometrical calculations and to
store the position of the sensor (Section~ \ref{sec:fm_defs:sensor}).

\leveld{Geometrical altitude \index{geometrical altitude}} The term
geometrical altitude signifies here the difference in radius between a
point and the geoid (Section~\ref{sec:fm_defs:geoid}) along the vector
to the centre of the coordinate system (see for example
Equation~\ref{eq:fm_defs:zground}). Hence, the geometrical altitude is
not measured along the local zenith direction (the normal to the
reference geoid). Geometrical altitudes are mainly used to
facilitate the input of the ground altitude, the sensor position and
the altitude of the pressure surfaces. This is the case as these
quantities are known rather with respect to the geoid than with
respect to the Earth's centre.


\levelc{Atmospheric grids and fields} \index{grid} \index{field}
%===================
\label{sec:fm_defs:grids}

As mentioned above, the vertical grid of the atmosphere consists of a
set of layers with equal pressure, the pressure grid (\verb|p_grid|).
This grid must of course always be specified. It is not allowed that
there is an altitude gap between the ground and the lowermost pressure
surface.  That is, the ground pressure must be smaller than the
pressure of the lowermost vertical grid surface. On the hand, it is
not necessary to match the ground and the first pressure surface, the
pressure grid can extend below the ground level. The upper end of the
pressure grid gives the practical upper limit of the atmosphere as
vacuum is assumed above. With other words, no absorption and
refraction take place above the uppermost pressure surface.

A latitude grid (\verb|alpha_grid|) must be specified for 2D and 3D.
For 2D, the latitudes shall be treated as the angular distance along
the orbit track, as described above in
Section~\ref{sec:fm_defs:atmdim}.  The latitude angle is throughout
calculated for the vector going from the centre of the coordinate
system to the point of concern. Hence, the latitudes here correspond
to the definition of the geocentric latitude, and not geodetic
latitudes (see Section~\ref{sec:ppath:geoid}). This is an accordance
to the definition of geometric altitudes found above. For 3D, a
longitude grid (\verb|beta_grid|) must also be specified. Valid ranges
for latitude and longitude values are given in
Section~\ref{sec:fm_defs:atmdim}.  The atmosphere is treated to be
undefined outside the latitude and longitude ranges covered by the
grids. This results in that a propagation path is not allowed to
cross a latitude or longitude end face of the atmosphere, it can only
enter or leave the atmosphere through the top of the atmosphere (the
uppermost pressure level). See further Section~\ref{sec:fm_defs:rte}.
The volume (or area for 2D) covered by the grids is denoted as the
\qindex{model atmosphere}.

If the longitude and latitude grids are not used for the selected
atmospheric dimensionality, the the longitude grid (for 1D and 2D) and
also the latitude grid (for 1D) are set to be empty [* SAB: I swapped
the order in the above two sentences, otherwise I wouldn't understand
them. Are they now correct? *], but the when dealing with the size of
variables the grid length shall be treated to be one
($\aVctLng{\Lat}=1$ and/or $\aVctLng{\Lon}=1$). For example, the
matrix describing the geoid (see Section~\ref{sec:fm_defs:geoid}) has
for 1D the size $[1,1]$.

[* SAB: I think you are suggesting that just the existence of alpha\_grid
and beta\_grid should be considered as the switch to decide which
dimensionality we have. While this is very elegant, it could be in
practice confusing for the user. What if she just forgot to specify
beta\_grid? Or, how should the program behave if beta\_grid is there but
alpha\_grid not?

Suggestion: Have one WSV define the dimensionality explicitly:

\begin{verbatim}
  wsv_data.push_back
    (WsvRecord
     ("dimension",
     "The dimensionality of the calculation. For details, see user guide,\n"
     "Chapter 2. Allowed values:\n"
     "\n"
     "1: 1-D\n"
     "2: 2-D\n"
     "3: 3-D\n",
      Index_));
\end{verbatim}
      
All methods dealing with geometry can then verify that the grids
specified (p\_grid, alpha\_grid, beta\_grid) are consistent with
the chosen dimensionality.

Actually, maybe we need a similar flag to specify how many Stokes
components should be used.

\begin{verbatim}
  wsv_data.push_back
    (WsvRecord
     ("polarization",
     "How many Stokes components are used. Allowed value: 1-4.",
      Index_));
\end{verbatim}

What do you think, Patrick? *]

The basic atmospheric quantities are represented by their values at
each crossing of the involved grids (indicated by thick dots in
Figure~\ref{fig:fm_defs:2d}), or for 1D at each pressure surface
(thick dots in Figure~\ref{fig:fm_defs:1d}). This representation is
denoted as the field of the quantity. The field must, at least, be
specified for the geometric altitude of the pressure surfaces
(\verb|z_field|), the temperature (\verb|t_field|) and considered
atmospheric species (\verb|????|).

The fields are assumed to be piece-wise linear functions vertically
(with pressure altitude as the vertical coordinate,
Section~\ref{sec:fm_defs:altitudes}), and along the latitude and
longitude edges of 2D and 3D grid boxes. For points inside 2D and 3D
grid boxes, multidimensional linear interpolation is applied (that is,
bilinear interpolation for 2D etc.). Note especially that this is also
valid for the field of geometrical altitudes (\verb|z_field|).

[* SAB: Stupid question: How does bilinear interpolation work
exactly? Do you first interpolate one coordinate on two grid faces,
and then the other one between the face values? Does the order make a
difference? And how is this in 3-D? Maybe we can talk about it on the
phone. *]

[* SAB: I think it would be important to explicitly specify the
structure of the field variables here. For example:

Fields are rank-3 tensors, for example \verb|z_field| has the
dimensions $[n_\beta,n_\alpha,n_P]$. FIXME: Re-sort, if we decide to
change the order! That means each field is like a book, with one page
for each longitude grid point, one row for each latitude grid point,
and one column for each pressure grid point. In the 1-D case there is
just one page with a single row of text.

I think the order p, alpha, beta would be better, see remark (**) at the
beginning.

*]


\levelc{The geoid and the ground}
%===================
\label{sec:fm_defs:geoid}

The geoid, \aRds{\odot}, is an imagery [* SAB: do you mean imaginary?
*] surface used as a reference surface when specifying the ground
altitude and the altitude of pressure surfaces. Any shape of the geoid
is allowed but a smoothly varying geoid is the natural choice, with
the centres of the geoid and the coordinate system coinciding. The
geoid should normally be set to the reference ellipsoid for some
global geodetic datum, such as WGS-84. For further reading on geoid
ellipsoids and WGS-84, see Section~\ref{sec:ppath:geoid}.

Inside ARTS, the geoid is represented as a matrix (\verb|r_geoid|),
holding the geoid radius for each crossing of the latitude and
longitude grids. The size of the matrix is accordingly $\aRds{\odot}
\SzeSmb [\aVctLng{\Lon},\aVctLng{\Lat}]$ and the geoid radius for a
specific position is $\aRds{\odot}(\aInd{\Lon},\aInd{\Lat})$. The
geoid is not defined outside the ranges covered by the latitude and
longitude grids, with the exception for 1D where the geoid by
definition is a full sphere. 
The ground altitude, \aAlt{g}, is given as the geometrical altitude
above the geoid. The radius for the ground is accordingly
\begin{equation}
  \aRds{g} = \aRds{\odot} + \aAlt{g}
 \label{eq:fm_defs:zground}
\end{equation}
As described in
Section~\ref{sec:fm_defs:grids}, it is not allowed that there is a gap
between the ground and the lowermost pressure level.

The ARTS variable for the ground altitude (\verb|z_ground|) is a
matrix of the same size as the geoid matrix.  For 1D, the ground is a
sphere by definition (as the geoid), while for 2D and 3D any shape is
allowed and a rough model of the ground topography can be made. For
example, for limb sounding into the troposphere, it could be of
importance to capture the intersection of the antenna beam by the
Himalayas, and maybe other mountain ridges.  However, it should be
noted that ground reflections are treated in a simplified manner and
accurate results cannot be expected beside when some conditions are
fulfilled (see Section~\ref{sec:fm_defs:groundrefl}).


\levelc{The cloud box}
%===================
\label{sec:fm_defs:cloudbox}

In order to save computational time, scattering calculations are
limited to the part of the atmosphere containing clouds and other
scattering objects (beside the ground). The atmospheric region in
which scattering shall be considered is denoted as the cloud box, and
it is discussed here as it acts as an additional atmospheric limit
when calculating propagation paths (see Section~\ref{sec:fm_defs:rte}). 

The cloud box is defined in such way that a propagation path that
leaves the cloud box has no opportunity to cross the cloud box
boundary at any other location (remember that there is no scattering
outside the cloud box). This requires that the lower limit of the
cloud box is throughout the ground. This is the case as if there would
be a gap between the ground and the cloud box, paths leaving the cloud
box in the nadir direction would re-enter the cloud box after a
reflection in the ground. [* I just realized that with a tilted ground
surface it is possible that a path bounces back into the cloud box.
What shall we do with this? SAB: I would just mention here that this
case is ignored. :-) Or better, mention this after the next paragraph,
because otherwise the reader will not understand the problem. *]

Beside the lower vertical limit, the cloud box is defined to be
rectangular in the used coordinate system, with limits exactly at
points of the involved grids. This means that the upper limit of the
cloud box equals a pressure surface. For 2D, the angular extension of
the cloud box is between two points of the latitude grid
(Figure~\ref{fig:fm_defs:2d}), and likewise for 3D but then also with
a longitude extension between two grid points.



\levelb{The sensor and data reduction}
%==============================================================================
\label{sec:fm_defs:sensor}

The instrument that detects the simulated radiation is denoted as the
sensor\index{sensor, the}. The forward model is constructed in such
way that a sensor must exists. For cases when only monochromatic
pencil beam radiation is of interest, the positions and directions for
which the radiation shall be calculated are given by specifying an
imagery sensor with infinite frequency and angular resolution. The
workspace variables for the sensor that always must be specified are
\verb|sensor_pos|, \verb|sensor_los|, \verb|antenna_psi_grid| and
\verb|Ha|. These variables are presented below, where they are first
discussed individually and then later together when it is described
how different measurement sequences are modelled in the most practical
way. Remaining sensor workspace variables are described last in this
section.


\levelc{Sensor position \index{sensor position}}
%===================
\label{sec:fm_defs:sensorpos}

The observation positions of the sensor are stored in
\verb|sensor_pos|. This is a matrix where each row corresponds to a
sensor position. The number of columns in the matrix equals the
atmospheric dimensionality (1 column for 1D etc.). The columns of the
matrix (from first to last) are radius, latitude and longitude. 

[*
SAB: (*) Why do you give the columns backward? Is this an accident or a
misunderstanding? The only thing that is `backward' about Tensors, is
that new higher dimensions are added at the beginning, which is quite
natural (think of a book containing pages containing rows containing
columns). I think longitude should be first here. 

Or better, we should change the order of the dimensions in the fields,
see remark at the beginning, then your sentence would be correct.

*]



Accordingly, row $i$ of \verb|sensor_pos| for a 3D case is
$(\aLon{i},\aLat{i},\aRds{i})$. The sensor position can be set to any
value, but the resulting propagation paths (also dependent on
\verb|sensor_los|) must be valid with respect to the model atmosphere
(see Section~\ref{sec:fm_defs:rte}). An obviously incorrect choice is to
place the senor below the ground altitude.

The fact that the sensor position can be given any value results in
that the radius must be used in \verb|sensor_pos|, in contrast to
\verb|z_ground| and \verb|z_field| where the altitude above the geoid
is applied. This is the case as the sensor can for 2D and 3D be
placed outside the covered latitude and longitude ranges, thus
outside the defined geoid and the geometrical altitude is undefined.

The sensor is treated to be motionless when calculating the spectrum,
or spectra, for each given observation position. One or several
spectra can be calculated for each position as described below.


\levelc{Line-of-sight\index{line-of-sight}}
%===================
\label{sec:fm_defs:los}

The viewing direction of the sensor, the line-of-sight, is described
with two angles, the zenith angle (\ZntAng) and the azimuth angle
(\AzmAng). The zenith angle exists for all atmospheric
dimensionalities, while the azimuthal angle only is defined for 3D.
The term line-of-sight is not only used in connection with the sensor,
it is also used to describe the local propagation direction along the
path taken by the observed radiation (Section~\ref{sec:fm_defs:rte}).
The zenith and azimuthal angles are defined identical in both these
contexts. This is expected as the position of the sensor is the end
point of the propagation path. The line-of-sight of propagation paths
is defined in the direction a photon travels to reach the sensor,
while the sensor line-of-sight is the direction the antenna is pointed
to receive the photons. This means that the sensor and path
line-of-sights (at the sensor) are parallel but go in opposite
directions. As a true sensor has a limited spatial resolution
(described by the antenna pattern), theoretically there are an
infinite number of line-of-sights associated with the sensor, but in
the forward model spectra are only calculated for a discrete set of
directions. If a sensor line-of-sight is mentioned without any
comments, this refers to the direction in which the centre of the
antenna pattern is directed.

The \qindex{zenith angle}, \ZntAng, is simply the angle between the
line-of-sight and the zenith direction. It should be mentioned that
the zenith and nadir directions are here defined to be along the line
passing the centre of the coordinate system and the point of concern
(Section~\ref{sec:ppath:geoid}). A nadir observation,
$\ZntAng=180\degree$, is thus a measurement towards the centre of the
coordinate system. The maximum absolute value of a zenith angle is
180\degree. For 1D and 3D, positive and negative zenith angles are
treated identically, while for 2D a distinction is made. In the case
of 2D, positive and negative zenith angles mean that the viewing
direction is towards higher and lower latitudes, respectively.

The \qindex{azimuthal angle}, \AzmAng, is given with respect to the
plane going through the north and south poles of the coordinate system
$(\Lat=\pm90\degree)$ and the sensor. The valid range is
$[-180\degree,180\degree]$ where angles are counted clockwise and
0\degree means that the viewing or propagation direction is north-wise.
Hence, +90\degree means that the direction of concern goes eastward.

The line-of-sight for propagation paths is discussed further in
Section~[**]. The sensor line-of-sights are stored in
\verb|sensor_los|. This workspace variable is a matrix, where the
first column holds zenith angles and the second column is azimuthal
angles. For 1D and 2D there is only one column in the matrix, while
for 3D a row $i$ of the matrix is $(\aAzmAng{i},\aZntAng{i})$. The
number of rows for \verb|sensor_los| must be the same as for
\verb|sensor_pos|.

[* SAB: Again, I think it is confusing, if the order of the columns is
oposite from the indices of the matrix it refers to. *]

\levelc{Sensor polarisation \index{sensor polarisation}}
%===================
\label{sec:fm_defs:sensorpol}

[* How shall this be handled? *]


\levelc{Sensor characteristics \index{sensor characteristics} and
  \qindex{data reduction}}  
%===================
\label{sec:fm_defs:sensorchar}

Sensor characteristics is used here as a comprehensive term for the
response of all sensor parts that affects how the field of
monochromatic pencil beam intensities are translated to the recorded
spectrum. For example, the antenna pattern, the side-band filtering
and response of the spectrometer channels are normally the most
important charcteristics for a microwave heterodyne radiometer. Any
processing of the spectral data that takes place before is denoted as
data reduction. The most common processing is to represent the
original spectra with a smaller set of values, that is, a reduction of
the data size. The most common data reduction techniques is binning
and Hotelling transformation by an eigenvector expansion
(Section~[**]). The sensor modelling in ARTS assumes that the sensor
characteristics are identical for all measured spectra.

The influence of sensor characteristics and data reduction is in ARTS
incorporated by a transfer matrices, as described in
Section~\ref{sec:formalism:sensor}. The application of these transfer
matrices assumes that each step is a linear operation, which should be
the case for the response of the parts of a well designed instrument.
A possible non-linear data reduction must be handled seperately.

The creation of sensor and data reduction transfer matrices is not
(yet?) included in ARTS and no workspace variables exist to describe
the indivudual sensor parts etc. The sensor and data reduction are
described a series of blocks, each having its own transfer matrix.  It
is necessary to introduce a number of transfer matrices for various
reasons. At least three matrices are needed, denoted as \aSnsMtr{a},
\aSnsMtr{b} and \aSnsMtr{c}.



\levelc{How to model a \qindex{measurement sequence}?} 
%===================
\label{sec:fm_defs:scandef}


\levelc{Remaining sensor workspace variables} 
%===================
\label{sec:fm_defs:sensorvars}

\aSnsMtr{b} and \aSnsMtr{c} are described above.


\levelb{Absorption and refractive index}
%==============================================================================
\label{sec:fm_defs:absorption}

[* Considerations for the calculation of absorption and refractive index ...
Tags, line-by-line, absorption models etc. *]



\levelb{Clear sky radiative transfer}
%==============================================================================
\label{sec:fm_defs:rte}

[* Approach for solving the radiative transfer problem without scattering. *]


\levelc{Ground reflections}
%===================
\label{sec:fm_defs:groundrefl}

[* Discuss limitations for the used scheme and when OK results can be
expected. The slope of the ground is considered! Can we include
diffuse ground reflections in a simple way? *]



\levelb{Scattering}
%==============================================================================
\label{sec:fm_defs:scattering}

[* Special quantities and considerations for scattering ... *]


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "uguide"
%%% End: 
