# Simple simulations of ground-based measurements of ozone at 110.8 GHz,
# mainly to test different sensor response functions.
#
# Author: Patrick Eriksson


Arts2 {

INCLUDE "general.arts"

# ---- Main grids -----------------------------------------------------------

NumericCreate( v0 )
NumericSet( v0, 1.108360400e+11 )

# A pressure grid rougly matching 0 to 80 km in 1 km steps.
VectorNLogSpace( p_grid, 81, 1.013e5, 1 )

# A dense grid centered at v0
#
VectorLinSpace( f_grid, -50e6, 50e6, 100e3 )
VectorAddScalar( f_grid, f_grid, v0 )


# ---- Species ---------------------------------------------------------------

SpeciesSet( abs_species, [ "O3" ] )


# ---- Atmospheric scenario --------------------------------------------------

AtmRawRead( t_field_raw, z_field_raw, vmr_field_raw, abs_species, 
                                                        "midlatitude-winter" )
AtmFieldsCalc


# ---- Absorption ------------------------------------------------------------

ReadXML( abs_lines, "amsu/amsub.hitran04_lines.xml" )
abs_lines_per_speciesCreateFromLines

abs_cont_descriptionInit


# ---- Observation geometry --------------------------------------------------

NumericCreate( z_platform )
NumericCreate( za )
 
# Platform altitude
NumericSet( z_platform, 50 )

# Zenith angle
NumericSet( z_platform, 65 )

MatrixSetConstant( sensor_pos, 1, 1, z_platform )
Copy( z_surface, sensor_pos )
sensor_posAddRgeoid
MatrixSetConstant( sensor_los, 1, 1, za )




sensorOff
#sensor_responseInit

RteCalc

}