import pyarts
import numpy as np

f = np.linspace(1e9, 300e12, 101)

x = pyarts.arts.predef.get_co2_ckdmt252(f, 1e4, 250, 400e-6)

x_ref = np.array([4.17401029e-22, 1.15328319e-14, 2.00414322e-13, 1.82230910e-12,
                  1.57748149e-11, 2.41863048e-10, 1.92216391e-07, 1.78175584e-06,
                  3.16142672e-09, 3.19233617e-10, 1.62167254e-10, 2.13370407e-10,
                  2.32639859e-11, 1.68303638e-11, 1.51915115e-11, 1.72146410e-11,
                  2.41820579e-11, 4.08692996e-11, 8.35729570e-11, 7.40967482e-10,
                  6.88601237e-10, 3.41206787e-09, 2.15132409e-08, 1.06592604e-05,
                  9.66800853e-07, 1.81850218e-08, 2.26945153e-09, 4.88285604e-10,
                  1.52692106e-10, 6.32611905e-11, 3.08247184e-11, 1.79627959e-11,
                  2.28784044e-11, 4.64161682e-11, 7.56850632e-11, 6.58895109e-09,
                  1.23230632e-06, 1.79721850e-06, 2.04999832e-09, 1.03142780e-10,
                  2.56222707e-11, 6.59008248e-12, 2.53698344e-12, 1.04205581e-12,
                  4.02209110e-13, 1.52903674e-13, 2.70401005e-12, 1.52474472e-11,
                  1.46004398e-09, 7.87548651e-10, 1.99048512e-08, 1.49460836e-08,
                  1.09991142e-11, 7.15046928e-11, 1.10954815e-14, 2.70439181e-15,
                  2.28191906e-13, 3.52132069e-13, 4.85054263e-16, 1.40252190e-15,
                  7.26182973e-12, 3.05367652e-11, 3.94926704e-10, 8.97443357e-11,
                  4.99717369e-12, 6.79619307e-11, 4.88848840e-15, 1.87747148e-12,
                  8.65186544e-12, 1.31298278e-10, 2.42505166e-10, 1.31584712e-13,
                  1.99542285e-15, 1.81333127e-13, 5.80074279e-13, 8.11337001e-14,
                  1.16903096e-11, 1.55213697e-12, 5.03800152e-16, 5.81926805e-14,
                  3.38806692e-14, 3.16732340e-12, 4.42583078e-11, 6.65719569e-11,
                  1.66840390e-15, 1.35852010e-16, 2.56059389e-17, 7.05328242e-18,
                  2.42778689e-18, 9.99663375e-19, 5.49077249e-19, 6.67009569e-19,
                  2.69045083e-18, 5.80839704e-17, 2.75464790e-13, 3.03369383e-12,
                  5.98102978e-13, 1.07464961e-16, 4.87705451e-18, 8.13188442e-19,
                  0.00000000e+00])

assert np.allclose(x, x_ref), "CO2-CKDMT252"
