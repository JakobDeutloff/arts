# Copyright (C) 2000 Stefan Buehler <sbuehler@uni-bremen.de>
#                    Patrick Eriksson <patrick@rss.chalmers.se>
#
# This file is free software; as a special exception the author gives
# unlimited permission to copy and/or distribute it, with or without 
# modifications, as long as this notice is preserved.
# 
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY, to the extent permitted by law; without even the
# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

AC_INIT(reconf)
AM_CONFIG_HEADER(config.h)

# The ARTS release number must go here:
AM_INIT_AUTOMAKE(arts,0.0)

# Maintainer mode switch. DOC++, as well as all LaTeX documents (DOC++
# and AUG) are only processed in maintainer mode. This is necessary so
# that users who don't have LaTeX or DOC++ can install the package.
#
# Does not work this way, don't use.
#
# AM_MAINTAINER_MODE

# Turn off optimization: (Leads to very long compilation times)
CXXFLAGS="-g -O0"

# C Compiler:
AC_PROG_CC
AC_PROG_CPP
# C++ Compiler:
AC_PROG_CXX
# C++ Preprocessor:
AC_PROG_CXXCPP

# LF_CONFIGURE_CC

# Configure the C++ Compiler
# LF_CONFIGURE_CXX
# LF_HOST_TYPE

# Allow --with-warnings flag to configure:
LF_SET_WARNINGS

# Omitted, because we are not building libraries.
# AC_PROG_RANLIB

# What's used by make install:
AC_PROG_INSTALL

# Provide standard headers:
AC_STDC_HEADERS

# Special headers that we need:
# AC_HAVE_HEADERS(getopt.h) (now included in the source)
AC_CHECK_HEADER(math.h, ,
        AC_MSG_ERROR( "required header <math.h> not found" ) )

# Check compiler characteristics
AC_C_INLINE
AC_C_CONST
AC_TYPE_SIZE_T
dnl AC_CHECK_SIZEOF(float)
dnl AC_CHECK_SIZEOF(double)

# Check for functions in math library
for func in fabs exp asin sin cos sqrt
do
        AC_CHECK_LIB(m, $func, ,
                AC_MSG_ERROR( "function $func not found in math library" ) )
done

# This is needed to put the corrects data paths into the example files
# in doc/examples:
#
# DOES NOT WORK!
#
#AC_SUBST (explicit_datadir) 
#explicit_datadir = 'hallo'  # $datadir


AC_MSG_CHECKING(if documentation should be generated)
AC_ARG_ENABLE(docs,
[  --enable-docs[=PKGS]       Turn on document generation [default=no]],
[case "${enableval}" in
  yes) ac_docgen=yes ;;
   no) ac_docgen=no ;;
    *) AC_MSG_ERROR(bad value ${enableval} for --enable-docs) ;;
esac],[ ac_docgen=no ])
AM_CONDITIONAL(ARTS_GENDOCS, test x$ac_docgen = xyes)
AC_MSG_RESULT([$ac_docgen])

dnl Kicked out:
dnl      doc/doxygen/latex/Makefile
dnl      doc/doc++/Makefile 
dnl         doc/doc++/html/Makefile 
dnl         doc/doc++/tex/Makefile 

AC_OUTPUT( 
arts.spec
Makefile 
   ami/Makefile 
      ami/arts/Makefile
      ami/file/Makefile
      ami/general/Makefile
      ami/hmatrix/Makefile 
      ami/math/Makefile
      ami/path/Makefile
      ami/physics/Makefile
      ami/plot/Makefile
      ami/retrieval/Makefile
   aii/Makefile 
   doc/Makefile 
   doc/index.html
      doc/icons/Makefile 
      doc/doxygen/Makefile
      doc/doxygen/Doxyfile
      doc/doxygen/html/Makefile
      doc/uguide/Makefile 
      doc/uguide/version.tex 
         doc/uguide/Figs/Makefile 
      doc/examples/Makefile 
      doc/emacs/Makefile
   m4/Makefile 
   src/Makefile 
   data/Makefile 
      data/atmosphere/Makefile 
         data/atmosphere/fascod/Makefile
      data/spectroscopy/Makefile 
         data/spectroscopy/hitran96/Makefile 
)

